{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./js/mutex_model.ts","webpack:///./js/mutex_box.ts","webpack:///./node_modules/input-listener/dist/js/input_listener.js"],"names":["root","factory","exports","module","define","amd","a","i","window","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","STATES","models","ncols","reduce","model","Math","max","col","colspan","model_map","Array","model_list","_ncols","this","concat","splice","length","dirty_data","_fill","MutexModel","USE_CHECK","FILL_EACHMODEL","append","fill","clear","index","indexOf","count","undefined","remove","move","v2","flags","USE_OFFSET","getModel","row","format","rect","round","min","trim","height","ceil","changed_models","idx","nstep","_pathTest","push","nrows","max_offset","optimal_col","test_model","rowspan","max_col","offset","alloc","before_rect","trimmed_rect","crossed_models","cover","slice","crossed_rect","calcWrap","abs","_compress","sort","b","cascading_trimmed_rect","crossed_model","indenting_models","models_nrow","capture_models","capture_features","capture_nindents","new_capture_models","new_capture_features","new_capture_nindents","nindents","col_end","feature","loss_nindent","item","model_nindent","apply","Number","next_col","row_end","under_model","cm_idx","nindent","im_idx","map","USE_EACHOFFSET","mask","result","right","wrap","calcOffset","flee_rect","target_rect","arg","next_model","isFinite","isNaN","list_index","pop","wrap_rect","ec","er","oc","or","ic","ir","r_end","c_end","use_bw","vf","hf","f","trimmed_offset","lw","rw","bw","tw","sorted_directions","j","lastIndexOf","InputListener","vessel","boxes","options","inputListener","_client_width","resize","client_width","clientWidth","_update","dragStart","e","getBoundingClientRect","_left","clientX","left","_top","clientY","top","target_box","_get_box","onPick","preventDefault","dragging","dragMove","_stay_timeout","clearTimeout","onMove","break","_e","_t","setTimeout","put","dragEnd","is_release","box","ceil_size","cell_size","listener","onDrop","onStay","activate","disable","capture","MutexBox","space","add","update","new_values","_width","_height","bottom","width","px","py","_hit","distance","Function","res","_x","space_left","_y","space_top","_w","space_right","_h","space_bottom","zx","zy","zd","sqrt","radian","atan2","r_h","atan","_h_rv","PI","_h_pi","cos","capture_top","capture_right","capture_bottom","capture_left","receive","addPoint","default","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","iterator","constructor","configurable","writable","ReferenceError","setPrototypeOf","getPrototypeOf","__proto__","_","u","TypeError","rotate","pinch","dragMove2","click","_activated_listener","_registered_listener","keyDown","_parts","_reference","keyUp","keyPress","mouse_mask","target","pointX","pointY","_listener_status","_points","_identifiers","forEach","_listener_options","EVENT_CONFIG","addEventListener","removeEventListener","MOUSE_EVENT_ID","pow","button","changedTouches","identifier","MOUSE_DOWN","MOUSE_MOVE","MOUSE_UP","TOUCH_START","TOUCH_MOVE","TOUCH_END","TOUCH_CANCEL","KEY_DOWN","KEY_UP","KEY_PRESS","CURSOR_EVENT_HANDLES","IS_DRAG","IS_ROTATE","IS_PINCH","PATTERN_MAP","arguments","getOwnPropertyDescriptors","defineProperties","_PRIVATE_METHODS","update_key_listener","match_keys","match","toLocaleLowerCase","isArray","next","done","get_keys","code","_LISTENER_PREPROCESSOR","split","_listeners","_parent","_key","_path","join","v","h","y","_mesh_value","_process_status","_process_values","kd_tasks","cursorDown","_max_points","_move","mx","my","dx","dy","_move2","sd","E","O","k","ra","cursorMove","eventDispenser","_leave","setListener","targetTouches","registPoint","cursorUp","some","registListener","updateListener","test","_is_mouse_event"],"mappings":"CAAA,SAA2CA,EAAMC,GAChD,GAAsB,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,SACb,GAAqB,mBAAXG,QAAyBA,OAAOC,IAC9CD,OAAO,GAAIH,OACP,CACJ,IAAIK,EAAIL,IACR,IAAI,IAAIM,KAAKD,GAAuB,iBAAZJ,QAAuBA,QAAUF,GAAMO,GAAKD,EAAEC,IAPxE,CASGC,QAAQ,WACX,O,YCTE,IAAIC,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUT,QAGnC,IAAIC,EAASM,EAAiBE,GAAY,CACzCJ,EAAGI,EACHC,GAAG,EACHV,QAAS,IAUV,OANAW,EAAQF,GAAUG,KAAKX,EAAOD,QAASC,EAAQA,EAAOD,QAASQ,GAG/DP,EAAOS,GAAI,EAGJT,EAAOD,QA0Df,OArDAQ,EAAoBK,EAAIF,EAGxBH,EAAoBM,EAAIP,EAGxBC,EAAoBO,EAAI,SAASf,EAASgB,EAAMC,GAC3CT,EAAoBU,EAAElB,EAASgB,IAClCG,OAAOC,eAAepB,EAASgB,EAAM,CAAEK,YAAY,EAAMC,IAAKL,KAKhET,EAAoBe,EAAI,SAASvB,GACX,oBAAXwB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAepB,EAASwB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAepB,EAAS,aAAc,CAAE0B,OAAO,KAQvDlB,EAAoBmB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQlB,EAAoBkB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFAvB,EAAoBe,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOlB,EAAoBO,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRtB,EAAoB0B,EAAI,SAASjC,GAChC,IAAIgB,EAAShB,GAAUA,EAAO4B,WAC7B,WAAwB,OAAO5B,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAO,EAAoBO,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRT,EAAoBU,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzG5B,EAAoB+B,EAAI,GAIjB/B,EAAoBA,EAAoBgC,EAAI,G,oCC/EhDC,E,qRAAL,SAAKA,GACD,6BACA,wCACA,iCACA,0CAJJ,CAAKA,MAAM,KAMX,iBAKI,WACIC,EACAC,QAAA,IAAAA,MACID,EAAOE,QACH,SAACD,EAAOE,GAAU,OAAAC,KAAKC,IAAIJ,GAAQE,EAAMG,KAAO,IAAMH,EAAMI,SAAW,MACrE,IATJ,KAAAC,UAAsC,IAAIC,MAC1C,KAAAC,WAA2B,IAAID,MAEzC,KAAAE,OAAiB,KASbC,KAAKF,WAAaE,KAAKF,WAAWG,OAAOb,GACzCY,KAAKX,MAAQA,EA6brB,OA3bI,sBAAI,oBAAK,C,IAAT,WACI,OAAOW,KAAKD,Q,IAEhB,SAAUV,GACN,GAAIA,IAAUW,KAAKD,OAAQ,CACvBC,KAAKD,OAASV,EACdW,KAAKJ,UAAUM,OAAO,EAAGF,KAAKJ,UAAUO,QACxC,IAAIL,EAAaE,KAAKF,WAAWI,OAAO,EAAGF,KAAKF,WAAWK,QACvDC,EAAaJ,KAAKK,MAAMP,EAAYQ,EAAWnB,OAAOoB,UAAYD,EAAWnB,OAAOqB,gBACxFR,KAAKS,OAAOL,K,gCAIpB,YAAAM,KAAA,SAAKtB,GACDA,aAAkBS,QAAUT,EAAS,CAACA,IACtCY,KAAKK,MAAMjB,EAAQkB,EAAWnB,OAAOqB,iBAEzC,YAAAG,MAAA,SAAMpB,GACF,IAAIqB,EAAQZ,KAAKF,WAAWe,QAAQtB,GAAQuB,EAAQ,EAEpD,KADCF,GAAUZ,KAAKF,WAAWI,OAAOU,EAAO,KAChCA,EAAQZ,KAAKJ,UAAUiB,QAAQtB,KACpCuB,IACAd,KAAKJ,UAAUgB,QAASG,EAE5B,OAAOD,GAEX,YAAAE,OAAA,SAAO5B,GACHA,aAAkBS,QAAUT,EAAS,CAACA,IACtCY,KAAKK,MAAMjB,IAEf,YAAA6B,KAAA,SAAK7B,EAA8B8B,EAAgDC,QAAA,IAAAA,MAAA,GAC/E/B,aAAkBS,QAAUT,EAAS,CAACA,IACtCY,KAAKgB,OAAO5B,GACZY,KAAKK,MAAMjB,EAAQ+B,EAAQb,EAAWnB,OAAOqB,eAAiBF,EAAWnB,OAAOiC,WAAYF,IAEhG,YAAAG,SAAA,SAAS3B,EAAa4B,GAClB,GAAI5B,GAAO,GAAK4B,GAAO,GAAK5B,EAAMM,KAAKX,MACnC,OAAOW,KAAKJ,UAAUF,EAAM4B,EAAMtB,KAAKX,QAG/C,YAAAkC,OAAA,SAAOC,EAAY9B,EAAgB4B,GAG/B,YAHe,IAAA5B,MAAM8B,EAAK9B,UAAK,IAAA4B,MAAME,EAAKF,KAC1CE,EAAK9B,IAAMF,KAAKiC,MAAMjC,KAAKC,IAAID,KAAKkC,IAAIhC,EAAKM,KAAKX,MAAQmC,EAAK7B,SAAU,IACzE6B,EAAKF,IAAM9B,KAAKiC,MAAMjC,KAAKC,IAAI6B,EAAK,IAC7BE,GAEX,YAAAG,KAAA,WAGI,IAFA,IAAIC,EAASpC,KAAKqC,KAAK7B,KAAKJ,UAAUO,OAASH,KAAKX,OAChDyC,EAAiB,GACZR,EAAM,EAAGA,EAAMM,EAAQN,IAC5B,IAAK,IAAI5B,EAAM,EAAGA,EAAMM,KAAKX,MAAOK,IAAO,CACvC,IAAIqC,EAAMT,EAAMtB,KAAKX,MAAQK,EACzBH,EAAQS,KAAKJ,UAAUmC,GAC3B,GAAIxC,GAASA,EAAM+B,MAAQA,EAAK,CAC5B,IAAIU,EAAQhC,KAAKiC,UAAU,CAAC1C,GAAQ,CAAC,GAAI+B,EAAM,GAAI/B,GAC/CyC,EAAQ,IACRF,EAAeI,KAAK3C,GACpBS,KAAKiB,KAAK,CAAC1B,GAAQ,CAAC,GAAIyC,KAE5BtC,GAAOH,EAAMI,QAAU,GAKnC,OAAOmC,GAGX,YAAArB,OAAA,SAAOrB,GACHA,aAAkBS,QAAUT,EAAS,CAACA,IACtC,IAAoB,UAAAA,EAAA,eAAQ,CAAvB,IAAMG,EAAK,KACZA,EAAMI,QAAUK,KAAKX,QAAUE,EAAMI,QAAUK,KAAKX,OAIpD,IAHA,IAAI8C,EAAQ3C,KAAKqC,KAAK7B,KAAKJ,UAAUO,OAASH,KAAKX,OAC/C+C,EAAa,EAAGC,EAAc,EAC9BC,EAAa,CAAE5C,IAAK,EAAG4B,IAAKa,EAAOxC,QAASJ,EAAMI,QAAS4C,QAAShD,EAAMgD,SACrE7C,EAAM,EAAG8C,EAAUxC,KAAKX,MAAQE,EAAMI,QAASD,GAAO8C,EAAS9C,IAAO,CAC3E4C,EAAW5C,IAAMA,EACjB,IAAI+C,EAASzC,KAAKiC,UAAU,CAACK,GAAa,CAAC,GAAIH,EAAQ,GAAIG,GACvDF,EAAaK,IACbL,EAAaK,EACbJ,EAAc3C,GAGtBH,EAAMG,IAAM2C,EACZ9C,EAAM+B,IAAMa,EAAQC,EACpBpC,KAAKK,MAAM,CAACd,GAAQe,EAAWnB,OAAOqB,kBAI9C,YAAAkC,MAAA,SACIlB,EACAmB,EACAC,EACAC,QADA,IAAAD,MAAqB5C,KAAKuB,OAAO,EAAD,GAAMC,UACtC,IAAAqB,MAA+B7C,KAAK8C,MAAMF,IAE1C,IAAId,EAAiBe,EAAeE,QACpC,GAA8B,IAA1BF,EAAe1C,OACf,OAAO2B,EAEX,IAAIkB,EAAehD,KAAKiD,SAASJ,GACjC,GACIF,GACAC,EAAalD,MAAQsD,EAAatD,KAClCkD,EAAatB,MAAQ0B,EAAa1B,KAClCqB,EAAYhD,UAAYqD,EAAarD,SACrCgD,EAAYJ,UAAYS,EAAaT,UACpC/C,KAAK0D,IAAI1B,EAAK9B,IAAMsD,EAAatD,KAAOF,KAAK0D,IAAI1B,EAAKF,IAAM0B,EAAa1B,OACzEqB,EAAYhD,QAAUgD,EAAYJ,SAAW,IAC9C/C,KAAK0D,IAAIP,EAAYjD,IAAMsD,EAAatD,KAAOiD,EAAYhD,QAC3DH,KAAK0D,IAAIP,EAAYrB,IAAM0B,EAAa1B,KAAOqB,EAAYJ,QAAU,GAClC,IAAnCvC,KAAK8C,MAAMH,GAAaxC,OAExBH,KAAKiB,KACD4B,EACA,CAACF,EAAYjD,IAAMsD,EAAatD,IAAKiD,EAAYrB,IAAM0B,EAAa1B,WAErE,GAEC0B,EAAarD,QAAUqD,EAAaT,QACY,KAA/CK,EAAajD,QAAUiD,EAAaL,WAExCvC,KAAKmD,UAAUP,EAAcC,EAAgBG,EAAcxB,GAC9D,CACEqB,EAAeO,MAAK,SAACtG,EAAGuG,GAAM,OAAAvG,EAAEwE,IAAM+B,EAAE/B,OAExC,IADA,IAAIgC,EAAyB,EAAH,GAAQV,GACzB7F,EAAI,EAAGA,EAAI8F,EAAe1C,OAAQpD,IAAK,CAC5C,IAAIwG,EAAgBV,EAAe9F,GAE/BiD,KAAKmD,UACDG,EACA,CAACC,GACDA,OACAxC,GACA,GAEJ8B,EAAe3C,OAAOnD,IAAK,IAEvBuG,EAAuB5D,IAAM6D,EAAc7D,MAC3C4D,EAAuB3D,SACnB2D,EAAuB5D,IAAM6D,EAAc7D,IAC/C4D,EAAuB5D,IAAM6D,EAAc7D,KAG3C4D,EAAuB5D,IAAM4D,EAAuB3D,QACpD4D,EAAc7D,IAAM6D,EAAc5D,UAElC2D,EAAuB3D,QACnB4D,EAAc7D,IAAM6D,EAAc5D,QAAU2D,EAAuB5D,MAInF,GAA8B,IAA1BmD,EAAe1C,OACf,OAAO2B,EAGX,IAAI0B,EAA4B,GAC5BC,EAAwB,GAE5BT,EAAehD,KAAKiD,SAASJ,GAuB7B,IAtBA,IAAIlD,EAAUiD,EAAajD,QACvBH,KAAKC,IAAIuD,EAAatD,IAAMkD,EAAalD,IAAK,GAC9CF,KAAKC,IACDmD,EAAalD,IAAMkD,EAAajD,QAChCqD,EAAarD,QAAUqD,EAAatD,IAClC,GAGNgE,EAA0B,CAC1B,CACIhE,IAAKF,KAAKC,IAAImD,EAAalD,IAAKsD,EAAatD,KAC7C4B,IAAKsB,EAAatB,IAClB3B,QAAO,EACP4C,QAAS,IAGboB,EAEA,GACAC,EAA6C,CAAC,IAAI/D,MAAMF,GAASe,KAAKkC,EAAaL,UAGhFmB,EAAevD,QAAQ,CAC1B,IAAI0D,EAA8B,GAC9BC,EAEA,GACAC,EAAiD,GACrD,IAAK,IAAMrF,KAAOiF,EACdA,EAAiBjF,GAAK0E,MAAK,SAACtG,EAAGuG,GAAM,OAAAvG,EAAEwE,IAAM+B,EAAE/B,OAEnD,IAASvE,EAAI,EAAGA,EAAI2G,EAAevD,OAAQpD,IAAK,CAG5C,IAFA,IAAIwC,EAAQmE,EAAe3G,GACvBiH,EAAWJ,EAAiB7G,GACNkH,GAAjBvE,EAAMH,EAAMG,KAAqBH,EAAMI,QAASD,EAAMuE,EAASvE,IAAO,CAE3E,GADIwE,EAAUP,EAAiBjE,GAClB,CAET,IADA,IAAIyE,EAAe,EACVvD,EAAQ,EAAGA,EAAQsD,EAAQ/D,OAAS,EAAGS,IAAS,CACrD,IAAIwD,EAAOF,EAAQtD,GACnB,KAAIwD,EAAK9C,IAAM/B,EAAM+B,KAGjB,MAFA6C,GAAgBD,EAAQtD,EAAQ,GAAGU,KAAO8C,EAAK9C,IAAM8C,EAAK7B,SAKlEyB,EAAStE,EAAMH,EAAMG,MAAQyE,GAIrC,IADIE,EAAgB7E,KAAKC,IAAI6E,MAAMC,OAAQP,IACvB,EAGhB,GAFAJ,EAAiB7G,GAAKsH,GAEP,KADXzD,EAAQ4C,EAAiB3C,QAAQtB,IAEjCqB,EAAQ4C,EAAiBrD,OACzBqD,EAAiBtB,KAAK3C,GACtBkE,EAAYvB,KAAKmC,OACd,CACH,GAAIZ,EAAY7C,IAAUyD,EAEtB,SAEAZ,EAAY7C,GAASyD,OAI7BX,EAAexD,OAAOnD,EAAG,GACzB6G,EAAiB1D,OAAOnD,EAAG,GAC3BA,IAGR,IAAS6D,EAAQ,EAAGA,EAAQ8C,EAAevD,OAAQS,IAAS,CACpDrB,EAAQmE,EAAe9C,GAA3B,IACIyD,EAAgBT,EAAiBhD,GAEhC,IAAIlB,EAAMH,EAAMG,IADrB8E,EACA,IAA0BP,EAAUvE,EAAMH,EAAMI,QAASD,EAAMuE,EAASvE,IACpE,IACI,IAAI4B,EAAM/B,EAAM+B,IAAM/B,EAAMgD,QAASkC,EAAUnD,EAAM+C,EACrD/C,EAAMmD,EACNnD,IACF,CACE,IAAIoD,EAAc1E,KAAKJ,UAAUF,EAAM4B,EAAMtB,KAAKX,OAClD,GAAIqF,EAAa,CACb,IAAIC,EAASd,EAAmBhD,QAAQ6D,GAEpCE,GADAZ,OAAQ,EACES,EAAUnD,EAAM9B,KAAKC,IAAIF,EAAM+B,IAAMoD,EAAYpD,IAAK,IACpE,IAAgB,IAAZqD,EAAe,CACf,IAMIT,EANAW,EAASrB,EAAiB3C,QAAQ6D,GACtC,GAAIG,GAAU,GAAKpB,EAAYoB,IAAWD,EACtC,SAASJ,EAEbX,EAAmB3B,KAAKwC,GACxBX,EAAqB7B,KAAK8B,EAAW,IAAInE,MAAM6E,EAAY/E,SAASe,KAAK,KACrEwD,EAAUJ,EAAqBpE,KAASoE,EAAqBpE,GAAO,KAChEwC,KAAK,CACTZ,IAAKoD,EAAYpD,IACjBiB,QAASmC,EAAYnC,eAGzByB,EAAWD,EAAqBY,GAEpCX,EAAStE,EAAMgF,EAAYhF,KAAOF,KAAKC,IAAIuE,EAAStE,EAAMgF,EAAYhF,KAAMkF,GAC5E,QAKhBlB,EAAiBG,EACjBF,EAAmBG,EACnBF,EAAmBG,EAIvBP,EAAiBtD,OAAO,EAAG,GAC3BuD,EAAYvD,OAAO,EAAG,GAEtBF,KAAKiB,KAAKuC,EAAkBC,EAAYqB,KAAI,SAACxD,GAA0B,OAAC,EAAGA,MAAOhB,EAAWnB,OAAO4F,gBACpGjD,EAAiBA,EAAe7B,OAAOuD,GAE3C,OAAO1B,GAEX,YAAAgB,MAAA,SAAMkC,GAGF,IAFA,IAAIC,EAAS,GACTvF,EAAMsF,EAAKtF,IAAK4B,EAAM0D,EAAK1D,IACtBrD,EAAI,EAAGA,EAAI+G,EAAKzC,QAAStE,IAC9B,IAAK,IAAIT,EAAI,EAAGA,EAAIwH,EAAKrF,QAASnC,IAAK,CACnC,IAAI+B,EAAQS,KAAKJ,UAAWpC,EAAIkC,GAAQzB,EAAIqD,GAAOtB,KAAKX,OACxD,QAAc0B,IAAVxB,EAAqB,EACpB0F,EAAOpE,QAAQtB,IAAU0F,EAAO/C,KAAK3C,GACtC,IAAI2F,EAAQ3F,EAAMI,QAAUJ,EAAMG,IAAM,EACxClC,EAAIkC,EAAMwF,IAAU1H,EAAI0H,EAAQxF,IAI5C,OAAOuF,GAEX,YAAAhC,SAAA,SAAS7D,GAOL,IANA,IAAI+F,EAAO,CACPzF,IAAKN,EAAO,GAAGM,IACf4B,IAAKlC,EAAO,GAAGkC,IACf3B,QAASP,EAAO,GAAGO,QACnB4C,QAASnD,EAAO,GAAGmD,SAEdxF,EAAI,EAAGA,EAAIqC,EAAOe,OAAQpD,IAAK,CACpC,IAAIwC,EAAQH,EAAOrC,GACnBoI,EAAKzF,IAAMH,EAAMG,MAAQyF,EAAKxF,SAAWwF,EAAKzF,IAAMH,EAAMG,IAAKyF,EAAKzF,IAAMH,EAAMG,KAChFyF,EAAK7D,IAAM/B,EAAM+B,MAAQ6D,EAAK5C,SAAW4C,EAAK7D,IAAM/B,EAAM+B,IAAK6D,EAAK7D,IAAM/B,EAAM+B,KAChF6D,EAAKxF,QAAUwF,EAAKzF,IAAMH,EAAMG,IAAMH,EAAMI,UACvCwF,EAAKxF,SAAWJ,EAAMG,IAAMH,EAAMI,QAAUwF,EAAKzF,IAAMyF,EAAKxF,SACjEwF,EAAK5C,QAAU4C,EAAK7D,IAAM/B,EAAM+B,IAAM/B,EAAMgD,UACvC4C,EAAK5C,SAAWhD,EAAM+B,IAAM/B,EAAMgD,QAAU4C,EAAK7D,IAAM6D,EAAK5C,SAErE,OAAO4C,GAEX,YAAAC,WAAA,SAAWC,EAAiBC,GACxB,MAAO,CACHlI,EAAGiI,EAAU3F,KAAO4F,EAAY5F,IAAM4F,EAAY3F,SAClD1B,EAAGoH,EAAU3F,IAAM2F,EAAU1F,QAAU2F,EAAY5F,IACnDrB,EAAGgH,EAAU/D,KAAOgE,EAAYhE,IAAMgE,EAAY/C,SAClDc,EAAGgC,EAAU/D,IAAM+D,EAAU9C,QAAU+C,EAAYhE,MAGnD,YAAAjB,MAAR,SAAcjB,EAAiB+B,EAA+BoE,QAA/B,IAAApE,MAAA,GAC3B,IAAMhC,EAASmB,EAAWnB,OACtBiB,EAAuCe,EAAQhC,EAAOoB,UAAY,QAAKQ,EACvEnB,EAAYI,KAAKJ,UACjBE,EAAaE,KAAKF,WAClBT,EAAQW,KAAKX,MACjBmG,EACA,IAAK,IAAI5E,EAAQ,EAAGA,EAAQxB,EAAOe,OAAQS,IAAS,CAChD,IAAIrB,EAAQH,EAAOwB,GAGnB,GAAIO,EAAQhC,EAAOoB,YACfkF,SAASlG,EAAMI,WAAaJ,EAAMI,QAAU,GAC5C8F,SAASlG,EAAMgD,WAAahD,EAAMgD,QAAU,GACxCmD,MAAMnG,EAAMG,IAAMH,EAAM+B,MAAQ/B,EAAMG,IAAMH,EAAMI,QAAUN,GAC5De,EAAW8B,KAAK3C,OAJxB,CASA,IAAIoG,EAAa7F,EAAWe,QAAQtB,GACpC,GAAI4B,EAAQhC,EAAOqB,eAAgB,CAC/B,IAAoB,IAAhBmF,EAGA,SAFA7F,EAAWoC,KAAK3C,QAKhBoG,GAAc,GACd7F,EAAWI,OAAOyF,EAAY,GAIlCxE,EAAQhC,EAAO4F,gBACfxF,EAAMG,KAAO6F,EAAI3E,GAAO,GACxBrB,EAAM+B,KAAOiE,EAAI3E,GAAO,IACjBO,EAAQhC,EAAOiC,aACtB7B,EAAMG,KAAO6F,EAAI,GACjBhG,EAAM+B,KAAOiE,EAAI,IAIrB,IAFM,IAAA7F,EAAA,EAAAA,IAAK4B,EAAA,EAAAA,IAAK3B,EAAA,EAAAA,QAAS4C,EAAA,EAAAA,QAEhBtE,EAAI,EAAGA,EAAIsE,EAAStE,IACzB,IAAK,IAAIT,EAAI,EAAGA,EAAImC,EAASnC,IAAK,CAC9B,IAAIuE,EAAOvE,EAAIkC,GAAQzB,EAAIqD,GAAOjC,EAClC,GAAM8B,EAAQhC,EAAOoB,gBAAiCQ,IAAnBnB,EAAUmC,GAEtC,CACH,EAAG,CACC,KAAOvE,KACHoC,EAAWpC,EAAIkC,GAAQzB,EAAIqD,GAAOjC,QAAS0B,EAE/CvD,EAAImC,QACC1B,KACTkD,EAAQhC,EAAOqB,gBAAmBV,EAAW8F,MAC7CxF,EAAW8B,KAAK3C,GAChB,SAASiG,EAVT5F,EAAUmC,GAAOZ,EAAQhC,EAAOqB,eAAiBjB,EAAQgG,IAezE,OAAOnF,GAEH,YAAA6B,UAAR,SAAkB7C,EAAiB8B,EAAsB2E,QAAA,IAAAA,MAAmB7F,KAAKiD,SAAS7D,IAGtF,IAFA,IAAI0G,EAAa,EAAR5E,EAAG,GAAQ6E,EAAa,EAAR7E,EAAG,GAAQ8E,EAAK,EAAGC,EAAK,EAAGjE,EAAQ,EACxDkE,EAAKJ,GAAMA,EAAKtG,KAAK0D,IAAI4C,GAAKK,EAAKJ,GAAMA,EAAKvG,KAAK0D,IAAI6C,GACpDC,IAAOF,GAAMG,IAAOF,GAAI,CAE3B,GADAC,IAAOF,EAAME,GAAUE,EAAOD,GAAUE,EAEpCN,EAAUnG,IAAMsG,EAAK,GACrBH,EAAUnG,IAAMsG,EAAKH,EAAUlG,QAAUK,KAAKX,OAC9CwG,EAAUvE,IAAM2E,EAAK,EAErB,OAAOjE,EAEX,IAAoB,UAAA5C,EAAA,eAChB,IADC,IAAMG,EAAK,KACHtB,EAAIsB,EAAM+B,IAAK8E,EAAQnI,EAAIsB,EAAMgD,QAAStE,EAAImI,EAAOnI,IAC1D,IAAK,IAAIT,EAAI+B,EAAMG,IAAK2G,EAAQ7I,EAAI+B,EAAMI,QAASnC,EAAI6I,EAAO7I,IAAK,CAC/D,IAAIuE,EAAMvE,EAAIwI,GAAM/H,EAAIgI,GAAMjG,KAAKX,MACnC,GAAIW,KAAKJ,UAAUmC,KAAiD,IAAzC3C,EAAOyB,QAAQb,KAAKJ,UAAUmC,IACrD,OAAOC,EAKvBA,GAAS,EAEb,OAAO,GAEH,YAAAmB,UAAR,SACIP,EACAC,EACAG,EACAxB,EACA8E,QAHA,IAAAzD,MAA+B7C,KAAK8C,MAAMF,SAC1C,IAAAI,MAAqBhD,KAAKiD,SAASJ,SAEnC,IAAAyD,OAAA,GAEA,IAAIC,EAAKvD,EAAarD,QAAUqD,EAAaT,QACzCiE,EAAK5D,EAAaL,QAAUK,EAAajD,QACzC8G,GAAKF,EAAKC,GAAM,EACpBD,EAAKE,EAAIF,EAAK,EACdC,EAAKC,EAAID,EAAK,EACd,IAAIE,EAAiB1G,KAAKoF,WAAWxC,EAAcI,GAC/CP,EAASjB,EAAOxB,KAAKoF,WAAW5D,EAAMwB,GAAgB0D,EACtDC,EAAY,CAACnH,KAAK0D,IAAIsD,EAAK/D,EAAOrF,GAAI,CAACsJ,EAAetJ,EAAG,IAAKwJ,EAAY,CAACpH,KAAK0D,IAAIsD,EAAK/D,EAAOxE,GAAI,CAACyI,EAAezI,EAAG,GAAI0I,GAC/HA,EAAGzE,KAAK0E,GAAKA,EAAG1E,KAAKyE,GACrB,IAAkEE,EAA9DC,EAAY,CAACtH,KAAK0D,IAAIqD,EAAK9D,EAAOpE,GAAI,CAAC,EAAGqI,EAAerI,IACzDiI,IACAO,EAAK,CAACrH,KAAK0D,IAAIqD,EAAK9D,EAAOY,GAAI,CAAC,EAAGqD,EAAerD,IAClDyD,EAAG5E,KAAK2E,GAAKA,EAAG3E,KAAK4E,IAGzB,IADA,IAAIC,GAAqBT,EAAS,CAACK,EAAIC,EAAIE,EAAID,GAAM,CAACF,EAAIC,EAAIE,IAAK1D,MAAK,SAACtG,EAAGuG,GAAM,OAAAvG,EAAE,GAAKuG,EAAE,MAClFtG,EAAI,EAAGA,EAAIgK,EAAkB5G,OAAQpD,IAAK,CAC/C,IAAIiK,EAAID,EAAkBE,YAAYF,EAAkBhK,GAAG,IAK3D,GAJIiK,EAAIjK,IACJgK,EAAkB7G,OAAO8G,EAAG,GAC5BD,EAAkB7G,OAAOnD,EAAI,EAAG,EAAGgK,EAAkBhK,GAAG,MAEkB,IAA1EiD,KAAKiC,UAAUY,EAAgBkE,EAAkBhK,GAAG,GAAIiG,GAExD,OADAhD,KAAKiB,KAAK4B,EAAgBkE,EAAkBhK,GAAG,KACxC,EAGf,OAAO,GAtcJ,EAAAoC,OAASA,EAwcpB,EA3cA,GA4cA,UAAemB,G,moBChdf,WAkSkC,EAAAA,WAlS3B,UACP,IAAM4G,EAAgB,EAAQ,GAiSrB,EAAAA,gBA9RT,kBASI,WACWC,EACPC,EACOC,QAAA,IAAAA,MAAA,IAHX,MAKI,YAAMD,EAAuBC,EAAQhI,QAAM,K,OAJpC,EAAA8H,SAEA,EAAAE,UAXX,EAAAC,cAAuC,KAO/B,EAAAC,cAAgB,EAkDxB,EAAAC,OAAS,SAACnI,QAAA,IAAAA,MAAgB,EAAKgI,QAAQhI,OACnC,IAAIoI,EAAe,EAAKJ,QAAQI,cAAgB,EAAKN,OAAOO,YACxDrI,IAAU,EAAKA,OAAS,EAAKkI,gBAAkBE,IAC/C,EAAKJ,QAAQhI,MAAQA,EACrB,EAAKA,MAAQA,EACb,EAAKkI,cAAgBE,EACrB,EAAKE,QAAQ,EAAK7H,cAmB1B,EAAA8H,UAAY,SAACC,EAA4BxJ,GAErC,IAAImD,EAAO,EAAK2F,OAAOW,wBACnBC,EAAQ1J,EAAE2J,QAAUxG,EAAKyG,KACzBC,EAAO7J,EAAE8J,QAAU3G,EAAK4G,IAG5B,OADA,EAAKC,WAAa,EAAKC,SAASP,EAAOG,EAAML,EAAGxJ,OAE5C,EAAKgK,YAED,EAAKhB,QAAQkB,QACb,EAAKlB,QAAQkB,OAAOV,EAAGxJ,EAAG,EAAKgK,eAGnCR,EAAEW,iBACF,EAAKH,WAAWI,UAAW,OAC3B,EAAKzH,OAAO,EAAKqH,cAOzB,EAAAK,SAAW,SAACb,EAA4B3G,EAAsB7C,GAQ1D,GAPA,EAAKgK,WAAWJ,MAAQ/G,EAAG,GAC3B,EAAKmH,WAAWD,KAAOlH,EAAG,GACtB,EAAKyH,gBACL3L,OAAO4L,aAAa,EAAKD,eACzB,EAAKA,cAAgB,MAGrB,EAAKtB,QAAQwB,QAAU,EAAKxB,QAAQwB,OAAOhB,EAAGxJ,EAAG,EAAKgK,YAGtD,OAFA,EAAKf,cAAcwB,aACnB,EAAKT,WAAa,MAGtB,EAAKU,GAAKlB,EACV,EAAKmB,GAAK3K,EACV,EAAKsK,cAAgB3L,OAAOiM,WAAW,EAAKC,IAAK,MAErD,EAAAC,QAAU,SAACtB,EAA4BxJ,GACnC,EAAKsK,eAAiB3L,OAAO4L,aAAa,EAAKD,eAC/C,EAAKI,GAAKlB,EACV,EAAKmB,GAAK3K,EACV,EAAK6K,KAAI,IA2Fb,EAAAA,IAAM,SACFE,EACAC,EACAxB,EACAxJ,QAFA,IAAAgL,MAAW,EAAKhB,iBAChB,IAAAR,MAA6B,EAAKkB,SAClC,IAAA1K,MAAwB,EAAK2K,IAmB7B,EAAKL,mBAAgB5H,EACrB,IAAIuI,EAAY,EAAKC,UACjB7J,EAAM2J,EAAIpB,KAAOqB,EAAWhI,EAAM+H,EAAIjB,IAAMkB,EAC5C9H,EAAO,CACP9B,IAAG,EAAE4B,IAAG,EACR3B,QAAS0J,EAAI1J,QACb4C,QAAS8G,EAAI9G,SAEbK,EAAe,EAAKrB,OAAO,EAAD,GAAMC,IAChCqB,EAAiB,EAAKC,MAAMF,GAC5B4G,EAAYJ,EAAa,EAAK/B,QAAQoC,OAAS,EAAKpC,QAAQqC,OAChE,GAAIF,GAAYA,EAAS3B,EAAGxJ,EAAGgL,EAAKxG,GAKhC,OAJKuG,GACD,EAAK9B,cAAcwB,aAEvB,EAAKT,WAAa,MAatB,EAAK3F,MAAMlB,EAAM6H,EAAazG,EAAcC,GAC5C,EAAKtB,OAAO8H,EAAa3J,EAAK4B,IACX,IAAf8H,IACAC,EAAIZ,UAAW,EACf,EAAK/H,KAAK2I,GACV,EAAK1B,QAAQ,CAAC0B,IACd,EAAKhB,WAAa,OApQtB,EAAKlB,OAASA,EACd,EAAKG,cAAgB,IAAIJ,EAAcC,EAAQ,CAC3CS,UAAW,EAAKA,UAChBc,SAAU,EAAKA,SACfS,QAAS,EAAKA,UAElB,EAAK3B,OAAO,EAAKnI,OACjB,EAAKsK,W,EAgQb,OAtRuB,OAwBnB,YAAAC,QAAA,WACI5J,KAAKsH,cAAcsC,WAEvB,sBAAI,sBAAO,C,IAAX,WACI,OAAO5J,KAAKqH,QAAQwC,SAAWC,EAASD,S,gCAE5C,sBAAI,oBAAK,C,IAAT,WACI,OAAO7J,KAAKqH,QAAQ0C,OAASD,EAASC,O,gCAE1C,YAAAJ,SAAA,WACI3J,KAAKwH,SACLxH,KAAKsH,cAAcqC,YAEvB,YAAAhI,KAAA,WACI3B,KAAK2H,QAAQ,YAAMhG,KAAI,aAE3B,YAAAe,MAAA,SAAMlB,EAAYmB,EAAoBC,EAAqBC,GACvD7C,KAAK2H,QAAQ,YAAMjF,MAAK,UAAClB,EAAMmB,EAAaC,EAAcC,KAE9D,YAAA7B,OAAA,SAAOoG,GACH,YAAMpG,OAAM,UAACoG,IAEjB,YAAA4C,IAAA,SAAI5C,GACAA,aAAiBvH,QAAUuH,EAAQ,CAACA,IACpC,IAAkB,UAAAA,EAAA,eAAO,CAApB,IAAMiC,EAAG,KACNA,EAAI3J,KAAO,GAAK2J,EAAI3J,IAAM2J,EAAI1J,SAAWK,KAAKX,OAASgK,EAAI/H,KAAO,GAClEtB,KAAK0C,MAAM2G,GACXrJ,KAAKU,KAAK2I,IAEVrJ,KAAKS,OAAO4I,GAGpBrJ,KAAK2H,QAAQP,IAWjB,YAAA6C,OAAA,SAAOZ,EAAWa,GACd,GAAIb,EAAK,CAEL,GADA,YAAM1I,MAAK,UAAC0I,GACRa,aAAsBrM,OAEtB,IAAK,IAAMa,KAAOwL,EACdb,EAAI3K,GAAOwL,EAAWxL,GAG9BsB,KAAK0C,MAAM2G,GACXrJ,KAAKU,KAAK2I,GACVrJ,KAAK2H,QAAQ,CAAC0B,SAEdrJ,KAAK2H,QAAQ3H,KAAKF,aAiDlB,YAAA6H,QAAR,SAAgBP,GAGZ,IAFA,IACIW,EAAOG,EAAMiC,EAAQC,EADrBd,EAAYtJ,KAAKuJ,UAEH,MAAAnC,EAAA,eAAO,CAApB,IAAMiC,EAAG,KACN,sBAAE,IAAApB,YAAA,IAAO,EAAP,IAAU,IAAA/C,aAAA,IAAQ,EAAR,IAAW,IAAAkD,IAAA,iBAAS,IAAAiC,cAAA,IAAS,EAAT,IACpCtC,EAAQuB,EAAYD,EAAI3J,IAAMuI,EAC9BC,EAAOoB,EAAYD,EAAI/H,IAAM,EAC7B6I,EAASb,EAAYD,EAAI1J,QAAUsI,EAAO/C,EAC1CkF,EAAUd,EAAYD,EAAI9G,QAAU,EAAM8H,EAE1CtC,IAAUsB,EAAIpB,OAASoB,EAAIpB,KAAOF,GAClCG,IAASmB,EAAIjB,MAAQiB,EAAIjB,IAAMF,GAC/BiC,IAAWd,EAAIiB,QAAUjB,EAAIiB,MAAQH,GACrCC,IAAYf,EAAIzH,SAAWyH,EAAIzH,OAASwI,KAGhD,sBAAI,wBAAS,C,IAAb,WACI,OAAOpK,KAAKuH,cAAgBvH,KAAKX,O,gCAE7B,YAAAiJ,SAAR,SAAiBiC,EAAYC,EAAY3C,EAA4BxJ,GACjE,IAAIiL,EAAYtJ,KAAKuJ,UACjBF,EAAuBrJ,KAAKqB,SAASkJ,EAAKjB,EAAY,EAAGkB,EAAKlB,EAAY,GAE9E,SAASmB,EAAKtK,EAAgBuK,EAAkBb,GAC5C,OAAIA,GAAW,EACJa,EAAWvK,EAAS0J,EAEpBa,GAAYvK,EAAS0J,GAAWa,EAAWvK,EAG1D,GAAIkJ,EAAK,CACL,IAAIQ,EAAUR,EAAIQ,SAAW7J,KAAK6J,QAClC,GAAIA,aAAmBc,SAAU,CAC7B,IAAIC,EAAMf,EAAQhC,EAAGxJ,EAAGgL,GACxB,OAAe,IAARuB,EAAevB,GAAe,IAARuB,OAAgB7J,EAAY6J,EAErD,0BACA,IAAAxC,IAAA,iBACA,IAAAlD,MAAA,iBACA,IAAAmF,OAAA,iBACA,IAAApC,KAAA,iBAGA,IAAAG,IAAA,iBACA,IAAAlD,MAAA,iBACA,IAAAmF,OAAA,iBACA,IAAApC,KAAA,iBAEA4C,EAAKxB,EAAI3J,IAAM4J,EAAYwB,EAC3BC,EAAK1B,EAAI/H,IAAMgI,EAAY0B,EAC3BC,EAAK5B,EAAI1J,QAAU2J,EAAY4B,EAAcJ,EAC7CK,EAAK9B,EAAI9G,QAAU+G,EAAY0B,EAAYI,EAE3CC,EAAKd,EAAKM,EAAKI,EAAK,EACpBK,EAAKd,EAAKO,EAAKI,EAAK,EACpBI,EAAK/L,KAAKgM,KAAK,SAAAH,EAAM,GAAI,SAAAC,EAAM,IAC/BG,EAASjM,KAAKkM,MAAMJ,EAAID,GACxBM,EAA2B,EAArBnM,KAAKoM,KAAKX,EAAKE,GAErBU,GADMrM,KAAKsM,GAAKH,GACF,EACdI,EAAQvM,KAAKsM,GAAK,EACtB,QAAQ,GACJ,KAAKL,GAAUI,GAASJ,GAAUE,EAAME,EACpC,OAAOpB,EAAKU,EAAK,EAAGI,EAAK/L,KAAKwM,IAAID,EAAQN,GAASQ,IAAgB5C,EACvE,KAAK7J,KAAK0D,IAAIuI,IAAWI,EACrB,OAAOpB,EAAKQ,EAAK,EAAGM,EAAK/L,KAAKwM,IAAIP,GAASS,IAAkB7C,EACjE,KAAKoC,EAASI,GAASJ,EAASI,EAAQF,EACpC,OAAOlB,EAAKU,EAAK,EAAG3L,KAAK0D,IAAIqI,EAAK/L,KAAKwM,IAAID,EAAQN,IAAUU,IAAmB9C,EACpF,KAAK7J,KAAK0D,IAAIuI,IAAWE,EAAME,EAC3B,OAAOpB,EAAKQ,EAAK,EAAGzL,KAAK0D,IAAIqI,EAAK/L,KAAKwM,IAAIP,IAAUW,IAAiB/C,KAM1F,YAAAgD,QAAA,SAAQxE,EAAGxJ,EAAGgL,GACNrJ,KAAKqI,aACLrL,OAAO4L,aAAa5I,KAAK2I,eACzB3I,KAAKkJ,KAAI,GACTlJ,KAAKsH,cAAcwB,SAEvB9I,KAAKqI,WAAagB,EACdxB,GAAKxJ,GACL2B,KAAKsH,cAAcgF,SAASjO,GAC5B2B,KAAK2I,cAAgB3L,OAAOiM,WAAWjJ,KAAKkJ,IAAK,MAEjDlJ,KAAKkJ,KAAI,IArNV,EAAAa,MAAgB,CAAE3B,IAAK,EAAGlD,MAAO,EAAGmF,OAAQ,EAAGpC,KAAM,GACrD,EAAA4B,QAAkB,CAAEzB,IAAK,EAAGlD,MAAO,EAAGmF,OAAQ,EAAGpC,KAAM,GACvD,EAAAf,cAAgBA,EAEhB,EAAA5G,WAAa,UAgRxB,EAtRA,CAAuB,WA8RC,EAAAwJ,WANxB,IACK9M,OAAe8M,SAAWA,EAC7B,MAAOjC,IAKT,UAAeiC,G,gBCxSgN9M,OAA3JL,EAAOD,QAA8K,SAASmL,GAAG,IAAIxJ,EAAE,GAAG,SAASJ,EAAEW,GAAG,GAAGP,EAAEO,GAAG,OAAOP,EAAEO,GAAGlC,QAAQ,IAAIK,EAAEsB,EAAEO,GAAG,CAAC7B,EAAE6B,EAAExB,GAAE,EAAGV,QAAQ,IAAI,OAAOmL,EAAEjJ,GAAGtB,KAAKP,EAAEL,QAAQK,EAAEA,EAAEL,QAAQuB,GAAGlB,EAAEK,GAAE,EAAGL,EAAEL,QAAQ,OAAOuB,EAAEV,EAAEsK,EAAE5J,EAAET,EAAEa,EAAEJ,EAAER,EAAE,SAASoK,EAAExJ,EAAEO,GAAGX,EAAEL,EAAEiK,EAAExJ,IAAIR,OAAOC,eAAe+J,EAAExJ,EAAE,CAACN,YAAW,EAAGC,IAAIY,KAAKX,EAAEA,EAAE,SAAS4J,GAAG,oBAAoB3J,QAAQA,OAAOC,aAAaN,OAAOC,eAAe+J,EAAE3J,OAAOC,YAAY,CAACC,MAAM,WAAWP,OAAOC,eAAe+J,EAAE,aAAa,CAACzJ,OAAM,KAAMH,EAAEI,EAAE,SAASwJ,EAAExJ,GAAG,GAAG,EAAEA,IAAIwJ,EAAE5J,EAAE4J,IAAI,EAAExJ,EAAE,OAAOwJ,EAAE,GAAG,EAAExJ,GAAG,iBAAiBwJ,GAAGA,GAAGA,EAAEtJ,WAAW,OAAOsJ,EAAE,IAAIjJ,EAAEf,OAAOY,OAAO,MAAM,GAAGR,EAAEA,EAAEW,GAAGf,OAAOC,eAAec,EAAE,UAAU,CAACb,YAAW,EAAGK,MAAMyJ,IAAI,EAAExJ,GAAG,iBAAiBwJ,EAAE,IAAI,IAAI9K,KAAK8K,EAAE5J,EAAER,EAAEmB,EAAE7B,EAAE,SAASsB,GAAG,OAAOwJ,EAAExJ,IAAIM,KAAK,KAAK5B,IAAI,OAAO6B,GAAGX,EAAEW,EAAE,SAASiJ,GAAG,IAAIxJ,EAAEwJ,GAAGA,EAAEtJ,WAAW,WAAW,OAAOsJ,EAAE0E,SAAS,WAAW,OAAO1E,GAAG,OAAO5J,EAAER,EAAEY,EAAE,IAAIA,GAAGA,GAAGJ,EAAEL,EAAE,SAASiK,EAAExJ,GAAG,OAAOR,OAAOkB,UAAUC,eAAe1B,KAAKuK,EAAExJ,IAAIJ,EAAEgB,EAAE,GAAGhB,EAAEA,EAAEiB,EAAE,GAAj5B,CAAq5B,CAAC,SAAS2I,EAAExJ,EAAEJ,GAAG,aAAa,SAASW,EAAEiJ,EAAExJ,GAAG,IAAIJ,EAAEJ,OAAO2O,KAAK3E,GAAG,GAAGhK,OAAO4O,sBAAsB,CAAC,IAAI7N,EAAEf,OAAO4O,sBAAsB5E,GAAGxJ,IAAIO,EAAEA,EAAE8N,QAAO,SAAUrO,GAAG,OAAOR,OAAO8O,yBAAyB9E,EAAExJ,GAAGN,eAAeE,EAAEiE,KAAKoC,MAAMrG,EAAEW,GAAG,OAAOX,EAAE,SAASlB,EAAE8K,GAAG,OAAO9K,EAAE,mBAAmBmB,QAAQ,iBAAiBA,OAAO0O,SAAS,SAAS/E,GAAG,cAAcA,GAAG,SAASA,GAAG,OAAOA,GAAG,mBAAmB3J,QAAQ2J,EAAEgF,cAAc3O,QAAQ2J,IAAI3J,OAAOa,UAAU,gBAAgB8I,IAAIA,GAAG,SAAS3I,EAAE2I,EAAExJ,EAAEJ,GAAG,OAAOI,KAAKwJ,EAAEhK,OAAOC,eAAe+J,EAAExJ,EAAE,CAACD,MAAMH,EAAEF,YAAW,EAAG+O,cAAa,EAAGC,UAAS,IAAKlF,EAAExJ,GAAGJ,EAAE4J,EAAE,SAASjK,EAAEiK,EAAExJ,GAAG,OAAOA,GAAG,WAAWtB,EAAEsB,IAAI,mBAAmBA,EAAE,SAASwJ,GAAG,QAAG,IAASA,EAAE,MAAM,IAAImF,eAAe,6DAA6D,OAAOnF,EAAvH,CAA0HA,GAAGxJ,EAAE,SAASvB,EAAE+K,GAAG,OAAO/K,EAAEe,OAAOoP,eAAepP,OAAOqP,eAAe,SAASrF,GAAG,OAAOA,EAAEsF,WAAWtP,OAAOqP,eAAerF,KAAKA,GAAG,SAASuF,EAAEvF,EAAExJ,GAAG,OAAO+O,EAAEvP,OAAOoP,gBAAgB,SAASpF,EAAExJ,GAAG,OAAOwJ,EAAEsF,UAAU9O,EAAEwJ,IAAIA,EAAExJ,GAAG,SAASgP,EAAExF,EAAExJ,GAAG,KAAKwJ,aAAaxJ,GAAG,MAAM,IAAIiP,UAAU,qCAAqC,SAAS9P,EAAEqK,EAAExJ,GAAG,IAAI,IAAIJ,EAAE,EAAEA,EAAEI,EAAE8B,OAAOlC,IAAI,CAAC,IAAIW,EAAEP,EAAEJ,GAAGW,EAAEb,WAAWa,EAAEb,aAAY,EAAGa,EAAEkO,cAAa,EAAG,UAAUlO,IAAIA,EAAEmO,UAAS,GAAIlP,OAAOC,eAAe+J,EAAEjJ,EAAEF,IAAIE,IAAI,SAAS6H,EAAEoB,EAAExJ,EAAEJ,GAAG,OAAOI,GAAGb,EAAEqK,EAAE9I,UAAUV,GAAGJ,GAAGT,EAAEqK,EAAE5J,GAAG4J,EAAE,IAAIzK,EAAE,CAACmQ,OAAO,WAAWC,MAAM,UAAUC,UAAU,cAAc7F,UAAU,cAAcc,SAAS,aAAaS,QAAQ,YAAYuE,MAAM,WAAWzO,EAAE,WAAW,SAAS4I,EAAExJ,EAAEJ,GAAG,IAAIW,EAAEoB,KAAKqN,EAAErN,KAAK6H,GAAG7H,KAAK2N,oBAAoB,GAAG3N,KAAK4N,qBAAqB,CAACL,OAAO,KAAKC,MAAM,KAAK9E,SAAS,KAAKd,UAAU,KAAKuB,QAAQ,KAAKsE,UAAU,KAAKC,MAAM,KAAKG,QAAQ,CAACC,OAAO,GAAGC,WAAW,GAAGC,MAAM,CAACD,WAAW,GAAGE,SAAS,CAACF,WAAW,IAAI/N,KAAKkO,WAAW,EAAElO,KAAKmO,OAAO,KAAKnO,KAAKoO,OAAO,QAAQpO,KAAKqO,OAAO,QAAQrO,KAAKsO,iBAAiB,GAAGtO,KAAKuO,QAAQ,GAAGvO,KAAKwO,aAAa,GAAG,IAAIzR,GAAE,EAAGiD,KAAKmO,OAAO9P,EAAEJ,KAAI,IAAKA,EAAElB,GAAE,GAAIA,EAAE,CAAC,UAAU,UAAU,WAAW0R,SAAQ,SAAU5G,QAAG,IAAS5J,EAAE4J,MAAM9K,IAAIA,EAAE,KAAK8K,GAAG5J,EAAE4J,OAAO,CAAC,SAAS,SAAS,cAAc4G,SAAQ,SAAU5G,QAAG,IAAS5J,EAAE4J,KAAKjJ,EAAEiJ,GAAG5J,EAAE4J,SAAS7H,KAAK0O,kBAAkB3R,EAAE,OAAO0J,EAAEoB,EAAE,CAAC,CAACnJ,IAAI,cAAcN,MAAM,SAASyJ,GAAG,IAAI,IAAIxJ,KAAKwJ,EAAE,IAAI7H,KAAKsO,iBAAiBjQ,KAAKwJ,EAAExJ,GAAG,CAAC,IAAIJ,EAAER,EAAEkR,aAAatQ,GAAGO,EAAEX,EAAE,GAAGlB,EAAEkB,EAAE,GAAGiB,EAAEjB,EAAE,IAAI+B,KAAKmO,OAAOtG,EAAExJ,GAAGa,EAAE0P,iBAAiBhQ,EAAEoB,KAAKjD,GAAGiD,KAAK0O,mBAAmBxP,EAAE2P,oBAAoBjQ,EAAEoB,KAAKjD,GAAGiD,KAAK0O,mBAAmB1O,KAAKsO,iBAAiBjQ,KAAKwJ,EAAExJ,MAAM,CAACK,IAAI,iBAAiBN,MAAM,SAASyJ,EAAExJ,GAAG,GAAG2B,KAAKwO,aAAa,KAAK/Q,EAAEqR,eAAetP,KAAKuP,IAAI,EAAElH,EAAEmH,QAAQhP,KAAKkO,YAAY7P,EAAEwJ,EAAEA,EAAE,QAAQ,GAAGA,EAAEoH,eAAe,IAAI,IAAIhR,EAAE,EAAEA,EAAE4J,EAAEoH,eAAe9O,OAAOlC,IAAI,CAAC,IAAIW,EAAEoB,KAAKwO,aAAa3N,QAAQgH,EAAEoH,eAAehR,GAAGiR,aAAa,IAAItQ,GAAGP,EAAEwJ,EAAEA,EAAEoH,eAAehR,GAAGW,MAAM,CAACF,IAAI,kBAAkBV,IAAI,WAAW,OAAOgC,KAAKwO,aAAa,KAAK/Q,EAAEqR,mBAAmBjH,EAA30C,GAAg1C5I,EAAE0P,aAAa,CAACQ,WAAW,CAAC,YAAY,cAAcC,WAAW,CAAC,YAAY,aAAapS,QAAQqS,SAAS,CAAC,UAAU,WAAWrS,QAAQsS,YAAY,CAAC,aAAa,cAAcC,WAAW,CAAC,YAAY,aAAavS,QAAQwS,UAAU,CAAC,WAAW,WAAWxS,QAAQyS,aAAa,CAAC,cAAc,WAAWzS,QAAQ0S,SAAS,CAAC,UAAU,WAAWC,OAAO,CAAC,QAAQ,SAASC,UAAU,CAAC,WAAW,aAAa3Q,EAAE4Q,qBAAqBhS,OAAO2O,KAAKpP,GAAG6B,EAAEE,OAAO,CAAC2Q,QAAQ,EAAEC,UAAU,EAAEC,SAAS,EAAEb,WAAW,aAAaC,WAAW,aAAaC,SAAS,WAAWC,YAAY,cAAcC,WAAW,aAAaC,UAAU,YAAYC,aAAa,eAAeC,SAAS,WAAWC,OAAO,SAASC,UAAU,aAAa3Q,EAAEgR,YAAY,SAASpI,GAAG,IAAI,IAAIxJ,EAAE,EAAEA,EAAE6R,UAAU/P,OAAO9B,IAAI,CAAC,IAAIJ,EAAE,MAAMiS,UAAU7R,GAAG6R,UAAU7R,GAAG,GAAGA,EAAE,EAAEO,EAAEf,OAAOI,IAAG,GAAIwQ,SAAQ,SAAUpQ,GAAGa,EAAE2I,EAAExJ,EAAEJ,EAAEI,OAAOR,OAAOsS,0BAA0BtS,OAAOuS,iBAAiBvI,EAAEhK,OAAOsS,0BAA0BlS,IAAIW,EAAEf,OAAOI,IAAIwQ,SAAQ,SAAUpQ,GAAGR,OAAOC,eAAe+J,EAAExJ,EAAER,OAAO8O,yBAAyB1O,EAAEI,OAAO,OAAOwJ,EAA7V,CAAgW,GAAGzK,EAAE,GAAG,CAACyQ,QAAQ,gBAAgBG,MAAM,cAAcC,SAAS,mBAAmBhP,EAAE6P,gBAAgB,iBAAiB7P,EAAEoR,iBAAiB,CAACC,oBAAoB,SAASzI,EAAExJ,EAAEJ,EAAEW,GAAGnB,EAAE4S,iBAAiBE,WAAWlS,GAAE,SAAUA,GAAG,IAAItB,EAAE8K,EAAExJ,GAAGtB,IAAIA,EAAE8K,EAAExJ,GAAG,IAAI,IAAIa,EAAEnC,EAAE8D,QAAQ5C,GAAGW,EAAEM,GAAG,IAAI2I,EAAEkG,aAAahR,EAAEoD,OAAO,EAAEpD,EAAEmD,OAAOhB,EAAE,UAAU2I,EAAExJ,KAAKwJ,EAAEkG,cAAc7O,GAAGnC,EAAEmF,KAAKjE,QAAQsS,WAAW,SAAS1I,EAAExJ,GAAG,IAAIJ,EAAE4J,EAAE2I,MAAM,0BAA0B,GAAGvS,EAAEA,EAAEA,EAAE6G,KAAI,SAAU+C,GAAG,OAAOA,EAAE4I,uBAAuB,IAAIpS,EAAE,OAAOJ,EAAE,IAAIW,EAAEX,EAAElB,EAAE8C,MAAM6Q,QAAQ9R,GAAGM,EAAE,EAAE,IAAIN,EAAE7B,EAAE6B,EAAEA,EAAEV,OAAO0O,cAAc,CAAC,IAAIhP,EAAE,GAAGb,EAAE,CAAC,GAAGmC,GAAGN,EAAEuB,OAAO,MAAMvC,EAAEgB,EAAEM,SAAS,CAAC,IAAIA,EAAEN,EAAE+R,QAAQC,KAAK,MAAMhT,EAAEsB,EAAEd,MAAM,GAAGC,EAAET,GAAG,QAAQiT,SAAS,SAAShJ,GAAG,OAAOA,EAAEiJ,MAAMjJ,EAAEnJ,MAAMmJ,EAAEiJ,KAAK,CAACjJ,EAAEnJ,IAAI+R,oBAAoB5I,EAAEiJ,KAAKL,qBAAqB,CAAC5I,EAAEnJ,IAAI+R,uBAAuBxR,EAAE8R,uBAAuB,CAAClD,QAAQ,SAAShG,EAAExJ,EAAEJ,GAAG,IAAIW,EAAE7B,EAAE8K,EAAE9E,MAAM,GAAG,GAAGiO,MAAM,KAAK9R,EAAEjB,EAAE,SAAS4J,EAAE5J,EAAEW,GAAG,GAAGA,EAAE,CAAC,IAAI7B,EAAE8K,EAAE5J,GAAG,GAAGlB,EAAE,CAAC,IAAImC,EAAEnC,EAAEkU,WAAWpQ,QAAQxC,IAAI,IAAIa,IAAInC,EAAEkU,WAAW/Q,OAAOhB,EAAE,GAAG,SAAS2I,EAAExJ,GAAG,IAAIJ,EAAEI,EAAE6S,UAAU7S,EAAE0P,YAAY,GAAG9P,WAAWA,EAAEI,EAAE8S,MAAMtJ,EAAE5J,IAAxE,CAA6ElB,OAAO,SAAS8K,EAAE5J,EAAElB,GAAG,IAAImC,EAAE2I,EAAE5J,GAAGiB,KAAKA,EAAE2I,EAAE5J,GAAG,CAACiT,QAAQrJ,EAAEsJ,KAAKlT,EAAE8P,WAAW,EAAED,OAAOjG,EAAEiG,OAAO7N,OAAOhC,KAAKmT,MAAMlS,EAAE4O,OAAOuD,KAAK,KAAKxJ,EAAEkG,cAAcnP,EAAEsD,KAAKhD,GAAGnC,IAAImC,EAAE6O,aAAa7O,EAAE+R,YAAY,IAAI/R,EAAE+R,WAAWpQ,QAAQxC,IAAIa,EAAE+R,WAAW/O,KAAK7D,GAAGa,EAAE+R,WAAW,CAAC5S,KAAKtB,EAAE0R,SAAQ,SAAU5G,GAAGjJ,EAAE,CAACoB,KAAK4N,qBAAqBC,SAAShG,EAAEmJ,MAAM,KAAKvC,SAAQ,SAAU5G,EAAExJ,EAAEJ,GAAG,IAAIlB,EAAE6B,EAAEhB,EAAEH,EAAE4S,iBAAiBE,WAAW1I,GAAG/K,EAAEmB,EAAEkC,SAAS9B,EAAE,EAAEO,EAAE,GAAG,IAAIwO,EAAErQ,EAAEsQ,EAAExN,MAAM6Q,QAAQtD,GAAG5P,EAAE,EAAE,IAAI4P,EAAEC,EAAED,EAAEA,EAAElP,OAAO0O,cAAc,CAAC,IAAInG,EAAE,GAAG4G,EAAE,CAAC,GAAG7P,GAAG4P,EAAEjN,OAAO,MAAMsG,EAAE2G,EAAE5P,SAAS,CAAC,IAAIA,EAAE4P,EAAEuD,QAAQC,KAAK,MAAMnK,EAAEjJ,EAAEY,MAAM,IAAIhB,EAAEqJ,EAAExH,EAAErB,EAAE0T,EAAEzR,MAAM6Q,QAAQzR,GAAGsS,EAAE,EAAE,IAAItS,EAAEqS,EAAErS,EAAEA,EAAEf,OAAO0O,cAAc,CAAC,IAAI4E,EAAE,GAAGF,EAAE,CAAC,GAAGC,GAAGtS,EAAEkB,OAAO,MAAMqR,EAAEvS,EAAEsS,SAAS,CAAC,IAAIA,EAAEtS,EAAE0R,QAAQC,KAAK,MAAMY,EAAED,EAAEnT,MAAMc,EAAE9B,EAAEoU,EAAE1U,OAAOkD,QAAQA,OAAOgO,MAAM,SAASnG,EAAExJ,EAAEJ,GAAGR,EAAE4S,iBAAiBC,oBAAoBtQ,KAAK4N,qBAAqBI,MAAMnG,EAAExJ,EAAEJ,IAAIgQ,SAAS,SAASpG,EAAExJ,EAAEJ,GAAGR,EAAE4S,iBAAiBC,oBAAoBtQ,KAAK4N,qBAAqBK,SAASpG,EAAExJ,EAAEJ,KAAK,IAAIR,EAAE,SAASoK,GAAG,SAASxJ,EAAEwJ,EAAE5J,EAAEW,GAAG,IAAI7B,EAAE,OAAOsQ,EAAErN,KAAK3B,IAAItB,EAAEa,EAAEoC,KAAKlD,EAAEuB,GAAGf,KAAK0C,KAAK6H,EAAEjJ,KAAK6S,YAAY,EAAE1U,EAAE2U,gBAAgB,EAAE3U,EAAE4U,gBAAgB,CAACC,SAAS,IAAI7U,EAAE8U,WAAW,SAAShK,GAAG,IAAI5J,EAAEW,EAAE7B,EAAEwR,QAAQ,GAAGxR,EAAEyR,aAAa,KAAKnQ,EAAEyQ,eAAe,GAAGjH,EAAEoH,gBAAgBrQ,EAAEuB,OAAOpD,EAAE+U,YAAY,CAAC,IAAI5S,EAAE2I,EAAEoH,eAAerR,EAAEiC,MAAM6Q,QAAQxR,GAAGpC,EAAE,EAAE,IAAIoC,EAAEtB,EAAEsB,EAAEA,EAAEhB,OAAO0O,cAAc,CAAC,IAAIQ,EAAE,GAAGxP,EAAE,CAAC,GAAGd,GAAGoC,EAAEiB,OAAO,MAAMiN,EAAElO,EAAEpC,SAAS,CAAC,IAAIA,EAAEoC,EAAEyR,QAAQC,KAAK,MAAMxD,EAAEtQ,EAAEsB,MAAM,IAAIiP,EAAED,EAAE,IAAI,IAAIrQ,EAAEyR,aAAa3N,QAAQwM,EAAE6B,YAAY,CAACjR,EAAEoP,EAAE,aAAa,IAAIzO,EAAEuB,QAAQX,KAAKuP,IAAI,EAAElH,EAAEmH,QAAQjS,EAAEmR,aAAajQ,EAAE4J,GAAG5J,GAAGlB,EAAEuP,SAASrO,EAAE4J,IAAI9K,EAAEgV,MAAM,SAASlK,EAAExJ,EAAEJ,GAAG,IAAIW,EAAE7B,EAAE4Q,oBAAoBzO,EAAEnC,EAAEwR,QAAQtQ,GAAGL,EAAES,EAAEtB,EAAEqR,QAAQtR,EAAEuB,EAAEtB,EAAEsR,QAAQ,GAAGzP,EAAE8J,SAAS,CAAC,IAAI0E,EAAE,CAACxP,EAAEsB,EAAE8S,GAAGlV,EAAEoC,EAAE+S,IAAIrT,EAAE8J,SAASb,EAAEuF,EAAE/O,IAAIa,EAAE8S,GAAGpU,EAAEwP,EAAE,GAAGlO,EAAE+S,GAAGnV,EAAEsQ,EAAE,KAAKlO,EAAE8S,GAAGpU,EAAEsB,EAAE+S,GAAGnV,GAAG8B,EAAE8O,OAAOlO,KAAK0D,IAAItF,EAAEsB,EAAEgT,IAAI1S,KAAK0D,IAAIpG,EAAEoC,EAAEiT,IAAIpV,EAAE0U,cAAc7S,EAAE8O,OAAM,IAAK3Q,EAAEqV,OAAO,SAASvK,EAAE5J,EAAEW,GAAG,IAAIM,EAAEb,EAAEc,OAAOvB,EAAEb,EAAE4Q,oBAAoB7Q,EAAEC,EAAE4U,gBAAgBvE,EAAErQ,EAAEwR,QAAQlB,EAAED,EAAExO,GAAGpB,EAAE4P,EAAE,IAAIxO,EAAE,EAAE,GAAG6H,EAAExI,EAAElB,EAAEqR,QAAQf,EAAE2E,GAAG5U,EAAEa,EAAElB,EAAEsR,QAAQhB,EAAE4E,GAAG,GAAGrU,EAAE6P,UAAU,CAAC,IAAIxO,EAAE,CAACwH,EAAE,EAAErJ,EAAE,GAAGQ,EAAE6P,UAAU5F,EAAE5I,EAAEhB,KAAKwI,GAAG,EAAExH,EAAE,GAAG7B,GAAG,EAAE6B,EAAE,IAAIoO,EAAE2E,GAAG3E,EAAE2E,GAAGvL,EAAE4G,EAAE4E,GAAG5E,EAAE4E,GAAG7U,EAAE,IAAIK,GAAG4P,EAAE2E,GAAGxU,EAAEwU,IAAI,EAAEV,GAAGjE,EAAE4E,GAAGzU,EAAEyU,IAAI,EAAE,GAAGrU,EAAE4P,MAAM,CAAC,IAAI+D,EAAE/R,KAAKgM,KAAKhM,KAAKuP,IAAI1B,EAAE2E,GAAGxU,EAAEwU,GAAG,GAAGxS,KAAKuP,IAAI1B,EAAE4E,GAAGzU,EAAEyU,GAAG,IAAIlV,EAAE2U,gBAAgBxS,EAAE8Q,SAASpS,EAAE4P,MAAM3F,IAAI/K,EAAEuV,IAAIvV,EAAEuV,GAAGd,KAAK/R,KAAK0D,IAAIqO,EAAEzU,EAAEuV,IAAItV,EAAE0U,cAAc1U,EAAE2U,iBAAiBxS,EAAE8Q,SAASpS,EAAE4P,MAAM3F,IAAI/K,EAAEuV,IAAIvV,EAAEuV,GAAGd,IAAI,CAAC9T,EAAE6T,KAAK,GAAG1T,EAAE2P,OAAO,CAAC,IAAIiE,EAAE,IAAI5S,EAAE,EAAEA,EAAE0T,EAAElF,EAAE,GAAG4E,GAAG5E,EAAEoE,GAAGQ,GAAGO,EAAEnF,EAAE,GAAG6E,GAAG7E,EAAEoE,GAAGS,GAAGO,EAAEhT,KAAKkM,MAAM6G,EAAED,GAAGE,EAAE1V,EAAE2V,IAAI,IAAI3V,EAAE2V,IAAI3V,EAAE2V,IAAI1V,EAAE2U,gBAAgBxS,EAAE6Q,WAAWnS,EAAE2P,OAAO1F,EAAE2K,EAAE1V,EAAE2V,IAAI3V,EAAE2V,GAAGD,GAAGhT,KAAK0D,IAAIsP,EAAE1V,EAAE2V,IAAI,IAAIjT,KAAKsM,KAAK/O,EAAE2U,iBAAiBxS,EAAE6Q,UAAUnS,EAAE2P,OAAO1F,EAAE2K,EAAE1V,EAAE2V,GAAG,CAAChV,EAAE6T,IAAIxU,EAAE2V,GAAGD,KAAKzV,EAAE2V,WAAW,SAAS7K,GAAG9K,EAAE4V,eAAe9K,EAAE9K,EAAEwR,QAAQpO,OAAO,EAAEpD,EAAEgV,MAAMhV,EAAEqV,SAASrV,EAAE6V,OAAO,SAAS/K,EAAE5J,EAAEW,GAAG,IAAIhB,EAAEb,EAAEyR,aAAatO,OAAOtB,EAAE,GAAG7B,EAAEwR,QAAQrO,OAAOtB,EAAE,GAAG,IAAI9B,EAAEuB,EAAEc,OAAOiO,EAAErQ,EAAEyR,aAAarO,OAAOkN,EAAEtQ,EAAE4Q,oBAAoB,QAAO,GAAI,KAAKP,EAAE,EAAErQ,EAAE8V,aAAa3T,EAAEtB,EAAE,GAAGd,EAAEqS,YAAW,GAAIjQ,EAAEtB,EAAEd,EAAEsS,YAAW,GAAIlQ,EAAEtB,EAAEd,EAAEuS,UAAS,GAAInQ,EAAEtB,EAAEd,EAAEyS,YAAW,GAAIrQ,EAAEtB,EAAEd,EAAE0S,WAAU,GAAItQ,EAAEtB,EAAEd,EAAE2S,cAAa,GAAI7R,IAAIb,EAAE2U,gBAAgB,EAAE7J,IAAIwF,EAAElE,SAASkE,EAAElE,QAAQtB,EAAE5J,GAAGoP,EAAEK,OAAOL,EAAEK,MAAM7F,EAAE5J,IAAI,MAAM,KAAK4J,GAAGuF,EAAErQ,EAAE+U,YAAY,GAAG/U,EAAE2U,gBAAgB5U,EAAEgT,QAAQjI,EAAEiL,eAAejL,EAAEiL,cAAc3S,QAAQpD,EAAE+U,YAAY,CAAC,IAAItU,EAAEqK,EAAEiL,cAAcrM,EAAE5G,MAAM6Q,QAAQlT,GAAGJ,EAAE,EAAE,IAAII,EAAEiJ,EAAEjJ,EAAEA,EAAEU,OAAO0O,cAAc,CAAC,IAAI3N,EAAE,GAAGwH,EAAE,CAAC,GAAGrJ,GAAGI,EAAE2C,OAAO,MAAMlB,EAAEzB,EAAEJ,SAAS,CAAC,IAAIA,EAAEI,EAAEmT,QAAQC,KAAK,MAAM3R,EAAE7B,EAAEgB,MAAM,IAAIX,EAAEwB,EAAE,IAAI,IAAIlC,EAAEyR,aAAa3N,QAAQpD,EAAEyR,YAAY,CAACnS,EAAEgW,YAAYlL,EAAEpK,GAAG,WAAWV,EAAEiW,SAAS,SAASnL,GAAG9K,EAAE4V,eAAe9K,EAAE9K,EAAE6V,SAAS7V,EAAE8Q,QAAQ,SAAShG,GAAG,IAAI5J,EAAElB,EAAE4U,gBAAgBC,SAAS,SAAShT,EAAEP,GAAG,GAAGA,EAAE,CAAC,IAAI,IAAIO,EAAEP,EAAE4S,WAAW5S,EAAE4S,WAAW9Q,OAAO,EAAEpD,EAAE,EAAEA,EAAE6B,EAAE7B,IAAI,IAAG,IAAKsB,EAAE4S,WAAWlU,GAAG8K,EAAExJ,EAAE+S,OAAO,OAAM,EAAG/S,EAAE0P,WAAWnP,IAAI,IAAIX,EAAE4C,QAAQxC,IAAIJ,EAAEiE,KAAK7D,IAAI,IAAIa,EAAEb,EAAEgS,iBAAiBQ,SAAShJ,GAAG,IAAI5J,EAAEgV,MAAK,SAAUpL,GAAG,OAAO3I,EAAE+T,MAAK,SAAU5U,GAAG,OAAOO,EAAEiJ,EAAExJ,UAAU,CAAC,IAAIT,EAAEsB,EAAEpC,EAAE+C,MAAM6Q,QAAQ9S,GAAGwP,EAAE,EAAE,IAAIxP,EAAEd,EAAEc,EAAEA,EAAEM,OAAO0O,cAAc,CAAC,IAAIS,EAAE,GAAGvQ,EAAE,CAAC,GAAGsQ,GAAGxP,EAAEuC,OAAO,MAAMkN,EAAEzP,EAAEwP,SAAS,CAAC,IAAIA,EAAExP,EAAE+S,QAAQC,KAAK,MAAMvD,EAAED,EAAEhP,MAAM,IAAIZ,EAAE6P,EAAE,GAAGzO,EAAE7B,EAAE6Q,qBAAqBC,QAAQrQ,IAAI,SAAST,EAAEiR,MAAM,SAASnG,GAAG,IAAI,IAAI5J,EAAEI,EAAEgS,iBAAiBQ,SAAShJ,GAAGjJ,EAAE7B,EAAE4U,gBAAgBC,SAAS1S,EAAE,SAAS2I,GAAG5J,EAAEgV,MAAK,SAAU5U,GAAG,OAAO,IAAIO,EAAEiJ,GAAGiG,OAAOjN,QAAQxC,OAAOO,EAAEsB,OAAO2H,IAAI,GAAGjK,EAAEiK,GAAGjK,EAAE,EAAEA,EAAEgB,EAAEuB,OAAOvC,IAAIsB,EAAEtB,GAAG,IAAId,EAAEC,EAAE6Q,qBAAqBI,MAAMZ,EAAEnP,EAAEoP,EAAExN,MAAM6Q,QAAQtD,GAAG5P,EAAE,EAAE,IAAI4P,EAAEC,EAAED,EAAEA,EAAElP,OAAO0O,cAAc,CAAC,IAAInG,EAAE,GAAG4G,EAAE,CAAC,GAAG7P,GAAG4P,EAAEjN,OAAO,MAAMsG,EAAE2G,EAAE5P,SAAS,CAAC,IAAIA,EAAE4P,EAAEuD,QAAQC,KAAK,MAAMnK,EAAEjJ,EAAEY,MAAM,IAAIhB,EAAEqJ,EAAE3J,EAAEM,IAAIN,EAAEM,GAAG6V,MAAK,SAAU5U,GAAG,OAAOA,EAAEwJ,QAAQ9K,EAAEkR,SAAS,SAASpG,GAAG,IAAI5J,EAAEI,EAAEgS,iBAAiBQ,SAAShJ,GAAGjJ,EAAE7B,EAAE6Q,qBAAqBK,SAAS/O,EAAEjB,EAAEL,EAAEiC,MAAM6Q,QAAQxR,GAAGpC,EAAE,EAAE,IAAIoC,EAAEtB,EAAEsB,EAAEA,EAAEhB,OAAO0O,cAAc,CAAC,IAAIQ,EAAE,GAAGxP,EAAE,CAAC,GAAGd,GAAGoC,EAAEiB,OAAO,MAAMiN,EAAElO,EAAEpC,SAAS,CAAC,IAAIA,EAAEoC,EAAEyR,QAAQC,KAAK,MAAMxD,EAAEtQ,EAAEsB,MAAM,IAAIiP,EAAED,EAAExO,EAAEyO,IAAIzO,EAAEyO,GAAG4F,MAAK,SAAU5U,GAAG,OAAOA,EAAEwJ,QAAQ9K,EAAEmW,eAAejV,GAAGlB,EAAE,OAAO,SAAS8K,EAAExJ,GAAG,GAAG,mBAAmBA,GAAG,OAAOA,EAAE,MAAM,IAAIiP,UAAU,sDAAsDzF,EAAE9I,UAAUlB,OAAOY,OAAOJ,GAAGA,EAAEU,UAAU,CAAC8N,YAAY,CAACzO,MAAMyJ,EAAEkF,UAAS,EAAGD,cAAa,KAAMzO,GAAG+O,EAAEvF,EAAExJ,GAA/N,CAAmOA,EAAEwJ,GAAGpB,EAAEpI,EAAE,CAAC,CAACK,IAAI,KAAKN,MAAM,SAASyJ,EAAExJ,GAAG,OAAO2B,KAAKmT,eAAejU,EAAE,GAAG2I,EAAExJ,MAAM,CAACK,IAAI,MAAMN,MAAM,SAASyJ,EAAExJ,GAAG,OAAO2B,KAAKmT,eAAejU,EAAE,GAAG2I,EAAExJ,IAAG,KAAM,CAACK,IAAI,WAAWN,MAAM,WAAW4B,KAAKmT,mBAAmB,CAACzU,IAAI,UAAUN,MAAM,WAAW,IAAIyJ,EAAE7H,KAAKA,KAAK6S,YAAYhV,OAAO2O,KAAKxM,KAAKsO,kBAAkBhP,QAAO,SAAUjB,EAAEJ,GAAG,OAAO4J,EAAEyG,iBAAiBrQ,KAAKI,EAAEJ,IAAG,GAAII,IAAI,OAAO,CAACK,IAAI,iBAAiBN,MAAM,SAASyJ,EAAE5J,GAAG,IAAIW,EAAE7B,EAAEiD,KAAK4N,qBAAqBhQ,EAAES,EAAEc,OAAO,GAAG0I,EAAE,IAAI,IAAI/K,KAAK+K,EAAE,IAAI,IAAIuF,KAAK/O,EAAE4R,YAAY5R,EAAE4R,YAAY7C,GAAGgG,KAAKtW,KAAKuB,EAAE0S,uBAAuB3D,GAAGvF,EAAE/K,IAAIuB,EAAE0S,uBAAuB3D,GAAG9P,KAAK0C,KAAKlD,EAAE+K,EAAE/K,GAAGmB,GAAGlB,EAAEqQ,GAAGnP,EAAE,KAAK4J,EAAE/K,IAAIkD,KAAK8R,YAAY/U,EAAEyQ,OAAOzQ,EAAEwQ,QAAQxQ,EAAE0Q,UAAU,EAAE,EAAE,IAAIJ,KAAKtQ,EAAE6K,WAAW7K,EAAE2L,UAAU3L,EAAE0Q,WAAW1Q,EAAEoM,SAASpM,EAAE2Q,OAAO3Q,EAAEyQ,OAAOzQ,EAAEwQ,QAAQ,OAAOvN,KAAK6S,aAAa3T,EAAEN,EAAE,GAAGhB,EAAEuR,WAAW9B,GAAGnO,EAAEN,EAAEhB,EAAE0R,YAAYjC,GAAGnO,EAAEN,EAAEhB,EAAE8R,SAAS3S,EAAE8Q,QAAQE,WAAW,GAAG7O,EAAEN,EAAEhB,EAAE+R,OAAO5S,EAAE8Q,QAAQE,WAAW,GAAGhR,EAAEiR,MAAMD,WAAW,GAAG7O,EAAEN,EAAEhB,EAAEgS,UAAU7S,EAAEkR,SAASF,WAAW,GAAGnP,IAAIoB,OAAO,CAACtB,IAAI,QAAQN,MAAM,WAAW,IAAI,IAAIyJ,EAAE7H,KAAKwO,aAAarO,SAAS0H,GAAG,GAAG7H,KAAK4S,YAAO,OAAO,EAAO/K,KAAK,CAACnJ,IAAI,cAAcN,MAAM,SAASyJ,GAAGnC,MAAMmC,KAAKA,EAAEA,EAAE7H,KAAKwO,aAAa3N,QAAQgH,EAAEqH,YAAY7Q,EAAEyQ,gBAAgB,GAAG9O,KAAK4S,YAAO,OAAO,EAAO/K,KAAK,CAACnJ,IAAI,WAAWN,MAAM,SAASyJ,EAAE5J,GAAG,IAAIW,EAAEoB,KAAKuO,QAAQxR,EAAEsB,EAAEwR,qBAAqB1P,OAAO,GAAG,IAAIvB,EAAEuB,OAAO,CAAC,IAAIjB,EAAEc,KAAK4N,qBAAqBhQ,EAAEK,GAAGiB,EAAE0I,WAAW1I,EAAE0I,UAAU3J,EAAE4J,KAAI,EAAG,IAAG,IAAKjK,EAAE,OAAOb,EAAE,EAAEsB,EAAEwR,qBAAqBvQ,QAAO,SAAUuI,EAAExJ,GAAG,OAAOa,EAAEb,MAAK,IAAKT,IAAIA,EAAEiD,QAAQxC,KAAKtB,IAAI8K,EAAExJ,GAAGa,EAAEb,WAAWwJ,EAAExJ,GAAGwJ,IAAI7H,KAAK2N,sBAAsB5Q,EAAE,GAAGA,EAAE,IAAIiD,KAAK2N,oBAAoB/F,YAAY5H,KAAK+S,YAAY9U,EAAE4J,KAAK,CAACnJ,IAAI,cAAcN,MAAM,SAASyJ,GAAG,IAAI5J,EAAEW,EAAE7B,EAAEmT,UAAU/P,OAAO,QAAG,IAAS+P,UAAU,GAAGA,UAAU,GAAGrI,EAAEjK,EAAES,EAAEc,OAAOrC,EAAEkD,KAAKuO,QAAQnB,EAAEpN,KAAK2N,oBAAoBN,EAAEtQ,EAAEiD,KAAKoO,QAAQ5Q,EAAET,EAAEiD,KAAKqO,QAAQ,OAAOvR,EAAEoF,KAAK,CAACgQ,GAAG7E,EAAE8E,GAAG3U,EAAEwU,GAAG3E,EAAE4E,GAAGzU,IAAIwC,KAAKwO,aAAatM,KAAKwD,MAAM3I,EAAEmS,YAAY7Q,EAAEyQ,eAAe/R,EAAEmS,YAAYpS,EAAEqD,QAAQ,KAAK,EAAEH,KAAK0R,gBAAgB9T,EAAEkS,QAAQlR,EAAEoB,KAAKqT,gBAAgBrT,KAAK6S,aAAa3T,EAAEjB,EAAE,GAAGL,EAAEuR,WAAWvQ,GAAGM,EAAEjB,EAAEL,EAAEwR,WAAWxQ,GAAGM,EAAEjB,EAAEL,EAAEyR,SAASzQ,GAAGM,EAAEjB,EAAEL,EAAE2R,YAAY3Q,GAAGM,EAAEjB,EAAEL,EAAE4R,WAAW5Q,GAAGM,EAAEjB,EAAEL,EAAE6R,cAAc7Q,GAAGX,IAAI,MAAM,KAAK,EAAE+B,KAAK2R,gBAAgBU,GAAG7S,KAAKgM,KAAKhM,KAAKuP,IAAIjS,EAAE,GAAGkV,GAAGlV,EAAE,GAAGkV,GAAG,GAAGxS,KAAKuP,IAAIjS,EAAE,GAAGmV,GAAGnV,EAAE,GAAGmV,GAAG,IAAIjS,KAAK2R,gBAAgBc,GAAGjT,KAAKkM,MAAM5O,EAAE,GAAGmV,GAAGnV,EAAE,GAAGmV,GAAGnV,EAAE,GAAGkV,GAAGlV,EAAE,GAAGkV,IAAI5E,EAAEM,QAAQN,EAAEM,OAAM,MAAO,CAAChP,IAAI,iBAAiBN,MAAM,SAASyJ,GAAG7H,KAAKmT,eAAetL,KAAK,CAACnJ,IAAI,iBAAiBN,MAAM,SAASyJ,GAAGA,GAAG7H,KAAKmT,eAAetL,GAAE,OAAQxJ,EAAx5M,CAA25MY,GAAG,IAAIjC,OAAOkK,cAAczJ,EAAE,MAAMoK,IAAIA,EAAEnL,QAAQe","file":"js/mutex_box.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n","\r\nimport { Model, Rect } from './interfaces';\r\n\r\nenum STATES {\r\n    USE_CHECK = 0x01,\r\n    FILL_EACHMODEL = 0x10,\r\n    USE_OFFSET = 0x100,\r\n    USE_EACHOFFSET = 0x1000,\r\n};\r\nclass MutexModel {\r\n    protected model_map: Array<Model | undefined> = new Array();\r\n    protected model_list: Array<Model> = new Array();\r\n    static STATES = STATES;\r\n    _ncols: number = null;\r\n    constructor(\r\n        models: Array<Model>,\r\n        ncols: number =\r\n            models.reduce(\r\n                (ncols, model) => Math.max(ncols, (model.col || 0) + (model.colspan || 1))\r\n                , 1\r\n            )\r\n    ) {\r\n        this.model_list = this.model_list.concat(models);\r\n        this.ncols = ncols;\r\n    }\r\n    get ncols(): number {\r\n        return this._ncols;\r\n    }\r\n    set ncols(ncols: number) {\r\n        if (ncols !== this._ncols) {\r\n            this._ncols = ncols;\r\n            this.model_map.splice(0, this.model_map.length);\r\n            let model_list = this.model_list.splice(0, this.model_list.length);\r\n            let dirty_data = this._fill(model_list, MutexModel.STATES.USE_CHECK | MutexModel.STATES.FILL_EACHMODEL);\r\n            this.append(dirty_data);\r\n        }\r\n    }\r\n\r\n    fill(models: Array<Model> | Model) {\r\n        models instanceof Array || (models = [models]);\r\n        this._fill(models, MutexModel.STATES.FILL_EACHMODEL);\r\n    }\r\n    clear(model: Model) {\r\n        let index = this.model_list.indexOf(model), count = 0;\r\n        ~index && (this.model_list.splice(index, 1));\r\n        while (~(index = this.model_map.indexOf(model))) {\r\n            count++;\r\n            this.model_map[index] = undefined;\r\n        }\r\n        return count;\r\n    }\r\n    remove(models: Array<Model> | Model) {\r\n        models instanceof Array || (models = [models]);\r\n        this._fill(models);\r\n    }\r\n    move(models: Array<Model> | Model, v2: [number, number] | Array<[number, number]>, flags: number = 0) {\r\n        models instanceof Array || (models = [models]);\r\n        this.remove(models);\r\n        this._fill(models, flags | MutexModel.STATES.FILL_EACHMODEL | MutexModel.STATES.USE_OFFSET, v2);\r\n    }\r\n    getModel(col: number, row: number): Model | undefined {\r\n        if (col >= 0 && row >= 0 && col < this.ncols) {\r\n            return this.model_map[col + row * this.ncols];\r\n        }\r\n    }\r\n    format(rect: Rect, col = rect.col, row = rect.row): Rect {\r\n        rect.col = Math.round(Math.max(Math.min(col, this.ncols - rect.colspan), 0));\r\n        rect.row = Math.round(Math.max(row, 0));\r\n        return rect;\r\n    }\r\n    trim(): Array<Model> {\r\n        let height = Math.ceil(this.model_map.length / this.ncols);\r\n        let changed_models = [];\r\n        for (let row = 1; row < height; row++) {\r\n            for (let col = 0; col < this.ncols; col++) {\r\n                let idx = row * this.ncols + col;\r\n                let model = this.model_map[idx];\r\n                if (model && model.row === row) {\r\n                    let nstep = this._pathTest([model], [0, -row - 1], model);\r\n                    if (nstep > 0) {\r\n                        changed_models.push(model);\r\n                        this.move([model], [0, -nstep]);\r\n                    }\r\n                    col += model.colspan - 1;\r\n                }\r\n            }\r\n        }\r\n\r\n        return changed_models;\r\n    }\r\n\r\n    append(models: Array<Model> | Model) {\r\n        models instanceof Array || (models = [models]);\r\n        for (const model of models) {\r\n            model.colspan > this.ncols && (model.colspan = this.ncols);\r\n            let nrows = Math.ceil(this.model_map.length / this.ncols);\r\n            let max_offset = 0, optimal_col = 0;\r\n            let test_model = { col: 0, row: nrows, colspan: model.colspan, rowspan: model.rowspan };\r\n            for (let col = 0, max_col = this.ncols - model.colspan; col <= max_col; col++) {\r\n                test_model.col = col;\r\n                let offset = this._pathTest([test_model], [0, -nrows - 1], test_model);\r\n                if (max_offset < offset) {\r\n                    max_offset = offset as number;\r\n                    optimal_col = col;\r\n                }\r\n            }\r\n            model.col = optimal_col;\r\n            model.row = nrows - max_offset;\r\n            this._fill([model], MutexModel.STATES.FILL_EACHMODEL);\r\n        }\r\n\r\n    }\r\n    alloc(\r\n        rect: Rect,\r\n        before_rect?: Rect,\r\n        trimmed_rect: Rect = this.format({ ...rect }),\r\n        crossed_models: Array<Model> = this.cover(trimmed_rect)\r\n    ): Array<Model> {\r\n        let changed_models = crossed_models.slice();\r\n        if (crossed_models.length === 0) {\r\n            return changed_models;\r\n        }\r\n        let crossed_rect = this.calcWrap(crossed_models);\r\n        if (\r\n            before_rect &&\r\n            trimmed_rect.col === crossed_rect.col &&\r\n            trimmed_rect.row === crossed_rect.row &&\r\n            before_rect.colspan === crossed_rect.colspan &&\r\n            before_rect.rowspan === crossed_rect.rowspan &&\r\n            (Math.abs(rect.col - crossed_rect.col) + Math.abs(rect.row - crossed_rect.row)) /\r\n            (before_rect.colspan + before_rect.rowspan) < 0.1 &&\r\n            Math.abs(before_rect.col - crossed_rect.col) / before_rect.colspan +\r\n            Math.abs(before_rect.row - crossed_rect.row) / before_rect.rowspan > 1 &&\r\n            this.cover(before_rect).length === 0\r\n        ) {\r\n            this.move(\r\n                crossed_models,\r\n                [before_rect.col - crossed_rect.col, before_rect.row - crossed_rect.row]\r\n            );\r\n        } else if (\r\n            (\r\n                crossed_rect.colspan + crossed_rect.rowspan >\r\n                (trimmed_rect.colspan + trimmed_rect.rowspan) * 1.6\r\n            ) ||\r\n            !this._compress(trimmed_rect, crossed_models, crossed_rect, rect)\r\n        ) {\r\n            crossed_models.sort((a, b) => a.row - b.row);\r\n            let cascading_trimmed_rect = { ...trimmed_rect };\r\n            for (let i = 0; i < crossed_models.length; i++) {\r\n                let crossed_model = crossed_models[i];\r\n                if (\r\n                    this._compress(\r\n                        cascading_trimmed_rect,\r\n                        [crossed_model],\r\n                        crossed_model as Rect,\r\n                        undefined,\r\n                        false\r\n                    )) {\r\n                    crossed_models.splice(i--, 1);\r\n                } else {\r\n                    if (cascading_trimmed_rect.col > crossed_model.col) {\r\n                        cascading_trimmed_rect.colspan +=\r\n                            cascading_trimmed_rect.col - crossed_model.col;\r\n                        cascading_trimmed_rect.col = crossed_model.col;\r\n                    }\r\n                    if (\r\n                        cascading_trimmed_rect.col + cascading_trimmed_rect.colspan <\r\n                        crossed_model.col + crossed_model.colspan\r\n                    ) {\r\n                        cascading_trimmed_rect.colspan =\r\n                            crossed_model.col + crossed_model.colspan - cascading_trimmed_rect.col;\r\n                    }\r\n                }\r\n            }\r\n            if (crossed_models.length === 0) {\r\n                return changed_models;\r\n            }\r\n\r\n            let indenting_models: Model[] = [];\r\n            let models_nrow: number[] = [];\r\n\r\n            crossed_rect = this.calcWrap(crossed_models);\r\n            let colspan = trimmed_rect.colspan -\r\n                Math.max(crossed_rect.col - trimmed_rect.col, 0) -\r\n                Math.max(\r\n                    trimmed_rect.col + trimmed_rect.colspan -\r\n                    crossed_rect.colspan - crossed_rect.col\r\n                    , 0\r\n                );\r\n\r\n            let capture_models: Model[] = [\r\n                {\r\n                    col: Math.max(trimmed_rect.col, crossed_rect.col),\r\n                    row: trimmed_rect.row,\r\n                    colspan,\r\n                    rowspan: 0\r\n                }\r\n            ];\r\n            let capture_features: {\r\n                [key: number]: Array<{ row: number, rowspan: number }>\r\n            } = {};\r\n            let capture_nindents: Array<number[] | number> = [new Array(colspan).fill(trimmed_rect.rowspan)];\r\n\r\n\r\n            while (capture_models.length) {\r\n                let new_capture_models: Model[] = [];\r\n                let new_capture_features: {\r\n                    [key: number]: Array<{ row: number, rowspan: number }>\r\n                } = {};\r\n                let new_capture_nindents: Array<number[] | number> = [];\r\n                for (const key in capture_features) {\r\n                    capture_features[key].sort((a, b) => a.row - b.row);\r\n                }\r\n                for (let i = 0; i < capture_models.length; i++) {\r\n                    let model = capture_models[i];\r\n                    let nindents = capture_nindents[i] as Array<number>;\r\n                    for (let col = model.col, col_end = col + model.colspan; col < col_end; col++) {\r\n                        let feature = capture_features[col];\r\n                        if (feature) {\r\n                            let loss_nindent = 0;\r\n                            for (let index = 0; index < feature.length - 1; index++) {\r\n                                let item = feature[index];\r\n                                if (item.row < model.row) {\r\n                                    loss_nindent += feature[index + 1].row - (item.row + item.rowspan);\r\n                                } else {\r\n                                    break;\r\n                                }\r\n                            }\r\n                            nindents[col - model.col] -= loss_nindent;\r\n                        }\r\n                    }\r\n                    let model_nindent = Math.max.apply(Number, nindents);\r\n                    if (model_nindent > 0) {\r\n                        capture_nindents[i] = model_nindent;\r\n                        let index = indenting_models.indexOf(model);\r\n                        if (index === -1) {\r\n                            index = indenting_models.length;\r\n                            indenting_models.push(model);\r\n                            models_nrow.push(model_nindent);\r\n                        } else {\r\n                            if (models_nrow[index] >= model_nindent) {\r\n                                //console.log(models_nrow[index] , model_nindent);\r\n                                continue;\r\n                            } else {\r\n                                models_nrow[index] = model_nindent;\r\n                            }\r\n                        }\r\n                    } else {\r\n                        capture_models.splice(i, 1);\r\n                        capture_nindents.splice(i, 1);\r\n                        i--;\r\n                    }\r\n                }\r\n                for (let index = 0; index < capture_models.length; index++) {\r\n                    let model = capture_models[index];\r\n                    let model_nindent = capture_nindents[index] as number;\r\n                    next_col:\r\n                    for (let col = model.col, col_end = col + model.colspan; col < col_end; col++) {\r\n                        for (\r\n                            let row = model.row + model.rowspan, row_end = row + model_nindent;\r\n                            row < row_end;\r\n                            row++\r\n                        ) {\r\n                            let under_model = this.model_map[col + row * this.ncols];\r\n                            if (under_model) {\r\n                                let cm_idx = new_capture_models.indexOf(under_model);\r\n                                let nindents: number[];\r\n                                let nindent = row_end - row + Math.max(model.row - under_model.row, 0);\r\n                                if (cm_idx === -1) {\r\n                                    let im_idx = indenting_models.indexOf(under_model);\r\n                                    if (im_idx >= 0 && models_nrow[im_idx] >= nindent) {\r\n                                        continue next_col;\r\n                                    }\r\n                                    new_capture_models.push(under_model);\r\n                                    new_capture_nindents.push(nindents = new Array(under_model.colspan).fill(0));\r\n                                    let feature = new_capture_features[col] || (new_capture_features[col] = []);\r\n                                    feature.push({\r\n                                        row: under_model.row,\r\n                                        rowspan: under_model.rowspan\r\n                                    });\r\n                                } else {\r\n                                    nindents = new_capture_nindents[cm_idx] as number[];\r\n                                }\r\n                                nindents[col - under_model.col] = Math.max(nindents[col - under_model.col], nindent);\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                capture_models = new_capture_models;\r\n                capture_features = new_capture_features;\r\n                capture_nindents = new_capture_nindents;\r\n            }\r\n\r\n\r\n            indenting_models.splice(0, 1);\r\n            models_nrow.splice(0, 1);\r\n\r\n            this.move(indenting_models, models_nrow.map((row): [number, number] => [0, row]), MutexModel.STATES.USE_EACHOFFSET);\r\n            changed_models = changed_models.concat(indenting_models);\r\n        }\r\n        return changed_models;\r\n    }\r\n    cover(mask: Rect): Array<Model> {\r\n        let result = [];\r\n        let col = mask.col, row = mask.row;\r\n        for (let r = 0; r < mask.rowspan; r++) {\r\n            for (let c = 0; c < mask.colspan; c++) {\r\n                let model = this.model_map[(c + col) + (r + row) * this.ncols];\r\n                if (model !== undefined) {\r\n                    ~result.indexOf(model) || result.push(model);\r\n                    let right = model.colspan + model.col - 1;\r\n                    c + col < right && (c = right - col);\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    calcWrap(models: Array<Model>): Rect {\r\n        let wrap = {\r\n            col: models[0].col,\r\n            row: models[0].row,\r\n            colspan: models[0].colspan,\r\n            rowspan: models[0].rowspan\r\n        };\r\n        for (let i = 1; i < models.length; i++) {\r\n            let model = models[i];\r\n            wrap.col > model.col && (wrap.colspan += wrap.col - model.col, wrap.col = model.col);\r\n            wrap.row > model.row && (wrap.rowspan += wrap.row - model.row, wrap.row = model.row);\r\n            wrap.colspan + wrap.col < model.col + model.colspan &&\r\n                (wrap.colspan += model.col + model.colspan - wrap.col - wrap.colspan);\r\n            wrap.rowspan + wrap.row < model.row + model.rowspan &&\r\n                (wrap.rowspan += model.row + model.rowspan - wrap.row - wrap.rowspan);\r\n        }\r\n        return wrap;\r\n    }\r\n    calcOffset(flee_rect: Rect, target_rect: Rect) {\r\n        return {\r\n            l: flee_rect.col - (target_rect.col + target_rect.colspan),\r\n            r: flee_rect.col + flee_rect.colspan - target_rect.col,\r\n            t: flee_rect.row - (target_rect.row + target_rect.rowspan),\r\n            b: flee_rect.row + flee_rect.rowspan - target_rect.row,\r\n        }\r\n    }\r\n    private _fill(models: Model[], flags: number | undefined = 0, arg?: any): Array<Model> | undefined {\r\n        const STATES = MutexModel.STATES;\r\n        let dirty_data: Array<Model> | undefined = flags & STATES.USE_CHECK ? [] : undefined;\r\n        let model_map = this.model_map;\r\n        let model_list = this.model_list;\r\n        let ncols = this.ncols;\r\n        next_model:\r\n        for (let index = 0; index < models.length; index++) {\r\n            let model = models[index];\r\n\r\n\r\n            if (flags & STATES.USE_CHECK) {\r\n                isFinite(model.colspan) || (model.colspan = 1);\r\n                isFinite(model.rowspan) || (model.rowspan = 1);\r\n                if (isNaN(model.col + model.row) || model.col + model.colspan > ncols) {\r\n                    dirty_data.push(model);\r\n                    continue;\r\n                }\r\n            }\r\n\r\n            let list_index = model_list.indexOf(model);\r\n            if (flags & STATES.FILL_EACHMODEL) {\r\n                if (list_index === -1) {\r\n                    model_list.push(model);\r\n                } else {\r\n                    continue;\r\n                }\r\n            } else {\r\n                if (list_index >= 0) {\r\n                    model_list.splice(list_index, 1);\r\n                }\r\n            }\r\n\r\n            if (flags & STATES.USE_EACHOFFSET) {\r\n                model.col += arg[index][0];\r\n                model.row += arg[index][1];\r\n            } else if (flags & STATES.USE_OFFSET) {\r\n                model.col += arg[0];\r\n                model.row += arg[1];\r\n            }\r\n            let { col, row, colspan, rowspan } = model;\r\n            //row + rowspan > this.nrows && (this.nrows = row + rowspan);\r\n            for (let r = 0; r < rowspan; r++) {\r\n                for (let c = 0; c < colspan; c++) {\r\n                    let idx = (c + col) + (r + row) * ncols;\r\n                    if (!(flags & STATES.USE_CHECK) || model_map[idx] === undefined) {\r\n                        model_map[idx] = flags & STATES.FILL_EACHMODEL ? model : arg;\r\n                    } else {\r\n                        do {\r\n                            while (c--) {\r\n                                model_map[(c + col) + (r + row) * ncols] = undefined;\r\n                            }\r\n                            c = colspan;\r\n                        } while (r--)\r\n                        flags & STATES.FILL_EACHMODEL && (model_list.pop());\r\n                        dirty_data.push(model);\r\n                        continue next_model;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return dirty_data;\r\n    }\r\n    private _pathTest(models: Model[], v2: [number, number], wrap_rect: Model = this.calcWrap(models)): number | boolean {\r\n        let ec = v2[0] | 0, er = v2[1] | 0, oc = 0, or = 0, nstep = 0;\r\n        let ic = ec && ec / Math.abs(ec), ir = er && er / Math.abs(er);\r\n        while (oc !== ec || or !== er) {\r\n            oc !== ec ? (oc = oc + ic) : (or = or + ir);\r\n            if (\r\n                wrap_rect.col + oc < 0 ||\r\n                wrap_rect.col + oc + wrap_rect.colspan > this.ncols ||\r\n                wrap_rect.row + or < 0\r\n            ) {\r\n                return nstep;\r\n            }\r\n            for (const model of models) {\r\n                for (let r = model.row, r_end = r + model.rowspan; r < r_end; r++) {\r\n                    for (let c = model.col, c_end = c + model.colspan; c < c_end; c++) {\r\n                        let idx = c + oc + (r + or) * this.ncols;\r\n                        if (this.model_map[idx] && models.indexOf(this.model_map[idx]) === -1) {\r\n                            return nstep;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            nstep += 1;\r\n        }\r\n        return true;\r\n    }\r\n    private _compress(\r\n        trimmed_rect: Rect,\r\n        crossed_models: Array<Model> = this.cover(trimmed_rect),\r\n        crossed_rect: Rect = this.calcWrap(crossed_models),\r\n        rect?: Rect,\r\n        use_bw = true\r\n    ): boolean {\r\n        let vf = crossed_rect.colspan / crossed_rect.rowspan;\r\n        let hf = trimmed_rect.rowspan / trimmed_rect.colspan;\r\n        let f = (vf + hf) / 4;\r\n        vf = f + vf / 2;\r\n        hf = f + hf / 2;\r\n        let trimmed_offset = this.calcOffset(trimmed_rect, crossed_rect);\r\n        let offset = rect ? this.calcOffset(rect, crossed_rect) : trimmed_offset;\r\n        let lw: any[] = [Math.abs(hf * offset.l), [trimmed_offset.l, 0]], rw: any[] = [Math.abs(hf * offset.r), [trimmed_offset.r, 0], lw];\r\n        lw.push(rw); rw.push(lw);\r\n        let tw: any[] = [Math.abs(vf * offset.t), [0, trimmed_offset.t]], bw: any[];\r\n        if (use_bw) {\r\n            bw = [Math.abs(vf * offset.b), [0, trimmed_offset.b]];\r\n            tw.push(bw); bw.push(tw);\r\n        }\r\n        let sorted_directions = (use_bw ? [lw, rw, tw, bw] : [lw, rw, tw]).sort((a, b) => a[0] - b[0]);\r\n        for (let i = 0; i < sorted_directions.length; i++) {\r\n            let j = sorted_directions.lastIndexOf(sorted_directions[i][2]);\r\n            if (j > i) {\r\n                sorted_directions.splice(j, 1);\r\n                sorted_directions.splice(i + 1, 0, sorted_directions[i][2]);\r\n            }\r\n            if (this._pathTest(crossed_models, sorted_directions[i][1], crossed_rect) === true) {\r\n                this.move(crossed_models, sorted_directions[i][1]);\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n}\r\nexport default MutexModel;//这里糊一个根导出，让 MutexModel 可以在其他模块被定义\r\n//module.exports = MutexModel;//使用 module.exports 是为了import 和 require 都直接可用","\r\n\r\n\r\nimport { Model, Rect, layout, Box, CaptureFunction, Options } from './interfaces';\r\n\r\nimport MutexModel from './mutex_model';\r\nconst InputListener = require('input-listener');\r\n\r\n\r\nclass MutexBox extends MutexModel {\r\n    inputListener?: typeof InputListener = null;\r\n    static space: layout = { top: 0, right: 0, bottom: 0, left: 0 };\r\n    static capture: layout = { top: 0, right: 0, bottom: 0, left: 0 };\r\n    static InputListener = InputListener;\r\n    private target_box?: Box;\r\n    static MutexModel = MutexModel;\r\n    private _stay_timeout?: number;\r\n    private _client_width = 0;\r\n    constructor(\r\n        public vessel: HTMLElement,\r\n        boxes?: Array<Box>,\r\n        public options: Options = {}\r\n    ) {\r\n        super(boxes as Array<Model>, options.ncols);\r\n        this.vessel = vessel;\r\n        this.inputListener = new InputListener(vessel, {\r\n            dragStart: this.dragStart,\r\n            dragMove: this.dragMove,\r\n            dragEnd: this.dragEnd,\r\n        });\r\n        this.resize(this.ncols);\r\n        this.activate();\r\n    }\r\n    disable() {\r\n        this.inputListener.disable();\r\n    }\r\n    get capture() {\r\n        return this.options.capture || MutexBox.capture;\r\n    }\r\n    get space() {\r\n        return this.options.space || MutexBox.space;\r\n    }\r\n    activate() {\r\n        this.resize();\r\n        this.inputListener.activate();\r\n    }\r\n    trim(): any {\r\n        this._update(super.trim() as Array<Box>);\r\n    }\r\n    alloc(rect: Rect, before_rect?: Rect, trimmed_rect?: Rect, crossed_models?: Array<Model>): any {\r\n        this._update(super.alloc(rect, before_rect, trimmed_rect, crossed_models) as Array<Box>);\r\n    }\r\n    remove(boxes: Array<Box> | Box) {\r\n        super.remove(boxes);\r\n    }\r\n    add(boxes: Array<Box> | Box) {\r\n        boxes instanceof Array || (boxes = [boxes]);\r\n        for (const box of boxes) {\r\n            if (box.col >= 0 && box.col + box.colspan <= this.ncols && box.row >= 0) {\r\n                this.alloc(box as Rect);\r\n                this.fill(box);\r\n            } else {\r\n                this.append(box);\r\n            }\r\n        }\r\n        this._update(boxes);\r\n    }\r\n    resize = (ncols: number = this.options.ncols) => {\r\n        let client_width = this.options.client_width || this.vessel.clientWidth;\r\n        if (ncols !== this.ncols || this._client_width !== client_width) {\r\n            this.options.ncols = ncols;\r\n            this.ncols = ncols;\r\n            this._client_width = client_width;\r\n            this._update(this.model_list as Array<Box>);\r\n        }\r\n    }\r\n    update(box?: Box, new_values?: Model) {\r\n        if (box) {\r\n            super.clear(box);\r\n            if (new_values instanceof Object) {\r\n                //Object.assign(box, new_values);\r\n                for (const key in new_values) {\r\n                    box[key] = new_values[key];\r\n                }\r\n            }\r\n            this.alloc(box as Rect);\r\n            this.fill(box);\r\n            this._update([box]);\r\n        } else {\r\n            this._update(this.model_list as Array<Box>);\r\n        }\r\n    }\r\n    dragStart = (e: TouchEvent | MouseEvent, t: Touch | MouseEvent) => {\r\n        //e.preventDefault();\r\n        let rect = this.vessel.getBoundingClientRect();\r\n        let _left = t.clientX - rect.left;\r\n        let _top = t.clientY - rect.top;\r\n        //let { col, row } = \r\n        this.target_box = this._get_box(_left, _top, e, t);\r\n        if (\r\n            this.target_box &&\r\n            !(\r\n                this.options.onPick &&\r\n                this.options.onPick(e, t, this.target_box)\r\n            )\r\n        ) {\r\n            e.preventDefault();\r\n            this.target_box.dragging = true;\r\n            this.remove(this.target_box);\r\n            return;\r\n        }\r\n        return true;\r\n    }\r\n    private _e?: TouchEvent | MouseEvent;\r\n    private _t?: Touch | MouseEvent;\r\n    dragMove = (e: TouchEvent | MouseEvent, v2: [number, number], t: Touch | MouseEvent) => {\r\n        this.target_box.left += v2[0];\r\n        this.target_box.top += v2[1];\r\n        if (this._stay_timeout) {\r\n            window.clearTimeout(this._stay_timeout);\r\n            this._stay_timeout = null;\r\n        }\r\n\r\n        if (this.options.onMove && this.options.onMove(e, t, this.target_box)) {\r\n            this.inputListener.break();\r\n            this.target_box = null;\r\n            return;\r\n        }\r\n        this._e = e;\r\n        this._t = t;\r\n        this._stay_timeout = window.setTimeout(this.put, 300);\r\n    }\r\n    dragEnd = (e: TouchEvent | MouseEvent, t: Touch | MouseEvent) => {\r\n        this._stay_timeout && window.clearTimeout(this._stay_timeout);\r\n        this._e = e;\r\n        this._t = t;\r\n        this.put(true);\r\n    }\r\n    private _update(boxes: Array<Box>) {\r\n        let ceil_size = this.cell_size;\r\n        let _left, _top, _width, _height;\r\n        for (const box of boxes) {\r\n            let { left = 0, right = 0, top = 0, bottom = 0 } = box.space || this.space;\r\n            _left = ceil_size * box.col + left;\r\n            _top = ceil_size * box.row + top;\r\n            _width = ceil_size * box.colspan - left - right;\r\n            _height = ceil_size * box.rowspan - top - bottom;\r\n\r\n            _left !== box.left && (box.left = _left);\r\n            _top !== box.top && (box.top = _top);\r\n            _width !== box.width && (box.width = _width);\r\n            _height !== box.height && (box.height = _height);\r\n        }\r\n    }\r\n    get cell_size() {\r\n        return this._client_width / this.ncols;\r\n    }\r\n    private _get_box(px: number, py: number, e: TouchEvent | MouseEvent, t: Touch | MouseEvent): Box | undefined {\r\n        let ceil_size = this.cell_size;\r\n        let box: Box | undefined = this.getModel(px / ceil_size | 0, py / ceil_size | 0) as (Box | undefined);\r\n\r\n        function _hit(length: number, distance: number, capture: number): boolean {\r\n            if (capture >= 0) {\r\n                return distance < length - capture;\r\n            } else {\r\n                return distance >= length + capture && distance < length;\r\n            }\r\n        }\r\n        if (box) {\r\n            let capture = box.capture || this.capture;\r\n            if (capture instanceof Function) {\r\n                let res = capture(e, t, box);\r\n                return res === true ? box : (res === false ? undefined : res);\r\n            } else {\r\n                let {\r\n                    top: space_top = 0,\r\n                    right: space_right = 0,\r\n                    bottom: space_bottom = 0,\r\n                    left: space_left = 0\r\n                } = box.space || this.space;\r\n                let {\r\n                    top: capture_top = 0,\r\n                    right: capture_right = 0,\r\n                    bottom: capture_bottom = 0,\r\n                    left: capture_left = 0\r\n                } = capture;\r\n                let _x = box.col * ceil_size + space_left;\r\n                let _y = box.row * ceil_size + space_top;\r\n                let _w = box.colspan * ceil_size - space_right - space_left;\r\n                let _h = box.rowspan * ceil_size - space_top - space_bottom;\r\n\r\n                let zx = px - _x - _w / 2;\r\n                let zy = py - _y - _h / 2;\r\n                let zd = Math.sqrt(zx ** 2 + zy ** 2);\r\n                let radian = Math.atan2(zy, zx);\r\n                let r_h = Math.atan(_w / _h) * 2;\r\n                let r_v = Math.PI - r_h;\r\n                let _h_rv = r_v / 2;\r\n                let _h_pi = Math.PI / 2;\r\n                switch (true) {\r\n                    case radian < -_h_rv && radian > -r_h - _h_rv://top\r\n                        return _hit(_h / 2, zd * Math.cos(_h_pi + radian), capture_top) && box;\r\n                    case Math.abs(radian) <= _h_rv://right\r\n                        return _hit(_w / 2, zd * Math.cos(radian), capture_right) && box;\r\n                    case radian > _h_rv && radian < _h_rv + r_h://bottom\r\n                        return _hit(_h / 2, Math.abs(zd * Math.cos(_h_pi + radian)), capture_bottom) && box;\r\n                    case Math.abs(radian) >= r_h + _h_rv://left\r\n                        return _hit(_w / 2, Math.abs(zd * Math.cos(radian)), capture_left) && box;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    receive(e, t, box: Box) {\r\n        if (this.target_box) {\r\n            window.clearTimeout(this._stay_timeout);\r\n            this.put(true);\r\n            this.inputListener.break();\r\n        }\r\n        this.target_box = box;\r\n        if (e && t) {\r\n            this.inputListener.addPoint(t);\r\n            this._stay_timeout = window.setTimeout(this.put, 300);\r\n        } else {\r\n            this.put(true);\r\n        }\r\n    }\r\n    put = (\r\n        is_release?: boolean,\r\n        box: Box = this.target_box,\r\n        e: TouchEvent | MouseEvent = this._e,\r\n        t: Touch | MouseEvent = this._t,\r\n    ) => {\r\n        /*if (box && this.target_box) {\r\n          window.clearTimeout(this._stay_timeout);\r\n          this.putBox(true);\r\n          this.inputListener.break();\r\n        }\r\n        if (e && t) {\r\n          if (!is_release) {\r\n            this.target_box = box;\r\n            this.inputListener.addPoint(t);\r\n          }\r\n        } else {\r\n          e = this._e;\r\n          t = this._t;\r\n          box || (box = this.target_box);\r\n          this._e = undefined;\r\n          this._t = undefined;\r\n        }*/\r\n        this._stay_timeout = undefined;\r\n        let ceil_size = this.cell_size;\r\n        let col = box.left / ceil_size, row = box.top / ceil_size;\r\n        let rect = {\r\n            col, row,\r\n            colspan: box.colspan,\r\n            rowspan: box.rowspan\r\n        }\r\n        let trimmed_rect = this.format({ ...rect });\r\n        let crossed_models = this.cover(trimmed_rect);\r\n        let listener = (is_release ? this.options.onDrop : this.options.onStay);\r\n        if (listener && listener(e, t, box, crossed_models as Array<Box>)) {\r\n            if (!is_release) {\r\n                this.inputListener.break();\r\n            }\r\n            this.target_box = null;\r\n            return;\r\n        }\r\n        /*if (e && t) {\r\n          let listener = (is_release ? this.options.onDrop : this.options.onStay);\r\n          if (listener && listener(e, t, box, crossed_models as Array<Box>)) {\r\n            if (!is_release) {\r\n              this.inputListener.break();\r\n            }\r\n            this.target_box = null;\r\n            return;\r\n          }\r\n        }*/\r\n        this.alloc(rect, box as Rect, trimmed_rect, crossed_models);\r\n        this.format(box as Rect, col, row);\r\n        if (is_release === true) {\r\n            box.dragging = false;\r\n            this.fill(box);\r\n            this._update([box]);\r\n            this.target_box = null;\r\n        }\r\n    }\r\n}\r\n\r\ntry {\r\n    (window as any).MutexBox = MutexBox;\r\n} catch (e) {\r\n\r\n}\r\n\r\nexport { InputListener, MutexBox, MutexModel };\r\nexport default MutexBox;\r\n//module.exports = MutexBox;//使用 module.exports 是为了import 和 require 都直接可用\r\n\r\n\r\n","!function(e,t){if(\"object\"==typeof exports&&\"object\"==typeof module)module.exports=t();else if(\"function\"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)(\"object\"==typeof exports?exports:e)[n]=r[n]}}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,\"a\",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p=\"\",r(r.s=0)}([function(e,t,r){\"use strict\";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){return(i=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(e)}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){return!t||\"object\"!==i(t)&&\"function\"!=typeof t?function(e){if(void 0===e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return e}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,r){return t&&c(e.prototype,t),r&&c(e,r),e}var l={rotate:/^rotate$/,pinch:/^pinch$/,dragMove2:/^dragMove2$/,dragStart:/^dragStart$/,dragMove:/^dragMove$/,dragEnd:/^dragEnd$/,click:/^click$/},p=function(){function e(t,r){var n=this;u(this,e),this._activated_listener={},this._registered_listener={rotate:null,pinch:null,dragMove:null,dragStart:null,dragEnd:null,dragMove2:null,click:null,keyDown:{_parts:[],_reference:0},keyUp:{_reference:0},keyPress:{_reference:0}},this.mouse_mask=1,this.target=null,this.pointX=\"pageX\",this.pointY=\"pageY\",this._listener_status={},this._points=[],this._identifiers=[];var i=!1;this.target=t,r&&(!0===r?i=!0:(i=[\"capture\",\"passive\",\"passive\"].forEach((function(e){void 0!==r[e]&&((i||(i={}))[e]=r[e])})),[\"pointX\",\"pointY\",\"mouse_mask\"].forEach((function(e){void 0!==r[e]&&(n[e]=r[e])})))),this._listener_options=i}return f(e,[{key:\"setListener\",value:function(e){for(var t in e)if(!this._listener_status[t]!=!e[t]){var r=d.EVENT_CONFIG[t],n=r[0],i=r[1],s=r[2]||this.target;e[t]?s.addEventListener(n,this[i],this._listener_options):s.removeEventListener(n,this[i],this._listener_options),this._listener_status[t]=!!e[t]}}},{key:\"eventDispenser\",value:function(e,t){if(this._identifiers[0]===d.MOUSE_EVENT_ID)Math.pow(2,e.button)&this.mouse_mask&&t(e,e,0);else if(e.changedTouches)for(var r=0;r<e.changedTouches.length;r++){var n=this._identifiers.indexOf(e.changedTouches[r].identifier);-1!==n&&t(e,e.changedTouches[r],n)}}},{key:\"_is_mouse_event\",get:function(){return this._identifiers[0]===d.MOUSE_EVENT_ID}}]),e}();p.EVENT_CONFIG={MOUSE_DOWN:[\"mousedown\",\"cursorDown\"],MOUSE_MOVE:[\"mousemove\",\"cursorMove\",window],MOUSE_UP:[\"mouseup\",\"cursorUp\",window],TOUCH_START:[\"touchstart\",\"cursorDown\"],TOUCH_MOVE:[\"touchmove\",\"cursorMove\",window],TOUCH_END:[\"touchend\",\"cursorUp\",window],TOUCH_CANCEL:[\"touchcancel\",\"cursorUp\",window],KEY_DOWN:[\"keydown\",\"keyDown\"],KEY_UP:[\"keyup\",\"keyUp\"],KEY_PRESS:[\"keypress\",\"keyPress\"]},p.CURSOR_EVENT_HANDLES=Object.keys(l),p.STATES={IS_DRAG:1,IS_ROTATE:2,IS_PINCH:4,MOUSE_DOWN:\"MOUSE_DOWN\",MOUSE_MOVE:\"MOUSE_MOVE\",MOUSE_UP:\"MOUSE_UP\",TOUCH_START:\"TOUCH_START\",TOUCH_MOVE:\"TOUCH_MOVE\",TOUCH_END:\"TOUCH_END\",TOUCH_CANCEL:\"TOUCH_CANCEL\",KEY_DOWN:\"KEY_DOWN\",KEY_UP:\"KEY_UP\",KEY_PRESS:\"KEY_PRESS\"},p.PATTERN_MAP=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},l,{},{keyDown:/^\\S+_keyDown$/,keyUp:/^\\S+_keyUp$/,keyPress:/^\\S+_keyPress$/}),p.MOUSE_EVENT_ID=-9007199254740991,p._PRIVATE_METHODS={update_key_listener:function(e,t,r,n){d._PRIVATE_METHODS.match_keys(t,(function(t){var i=e[t];i||(i=e[t]=[]);var s=i.indexOf(r);n?s>=0&&(e._reference--,i.length>1?i.splice(s,1):delete e[t]):(e._reference++,~s||i.push(r))}))},match_keys:function(e,t){var r=e.match(/(\\w+?| )(?=$|\\||,|\\+)/g);if(r=r?r.map((function(e){return e.toLocaleLowerCase()})):[],!t)return r;var n=r,i=Array.isArray(n),s=0;for(n=i?n:n[Symbol.iterator]();;){var o;if(i){if(s>=n.length)break;o=n[s++]}else{if((s=n.next()).done)break;o=s.value}if(t(o))break}},get_keys:function(e){return e.code&&e.key!==e.code?[e.key.toLocaleLowerCase(),e.code.toLocaleLowerCase()]:[e.key.toLocaleLowerCase()]}},p._LISTENER_PREPROCESSOR={keyDown:function(e,t,r){var n,i=e.slice(0,-8).split(\",\"),s=r?function(e,r,n){if(n){var i=e[r];if(i){var s=i._listeners.indexOf(t);-1!==s&&(i._listeners.splice(s,1),function e(t){var r=t._parent;--t._reference<=0&&r&&(delete r[t._key],e(r))}(i))}}}:function(e,r,i){var s=e[r];s||((s=e[r]={_parent:e,_key:r,_reference:0,_parts:e._parts.concat(r)})._path=s._parts.join(\"+\"),e._reference++),n.push(s),i&&(s._reference++,s._listeners?-1===s._listeners.indexOf(t)&&s._listeners.push(t):s._listeners=[t])};i.forEach((function(e){n=[this._registered_listener.keyDown],e.split(\"+\").forEach((function(e,t,r){var i=n,o=d._PRIVATE_METHODS.match_keys(e),a=r.length===t+1;n=[];var _=i,u=Array.isArray(_),c=0;for(_=u?_:_[Symbol.iterator]();;){var f;if(u){if(c>=_.length)break;f=_[c++]}else{if((c=_.next()).done)break;f=c.value}var l=f,p=o,v=Array.isArray(p),h=0;for(p=v?p:p[Symbol.iterator]();;){var y;if(v){if(h>=p.length)break;y=p[h++]}else{if((h=p.next()).done)break;y=h.value}s(l,y,a)}}}),this)}),this)},keyUp:function(e,t,r){d._PRIVATE_METHODS.update_key_listener(this._registered_listener.keyUp,e,t,r)},keyPress:function(e,t,r){d._PRIVATE_METHODS.update_key_listener(this._registered_listener.keyPress,e,t,r)}};var d=function(e){function t(e,r,n){var i;return u(this,t),(i=o(this,a(t).call(this,e,n)))._mesh_value=4,i._process_status=0,i._process_values={kd_tasks:[]},i.cursorDown=function(e){var r,n=i._points;if(i._identifiers[0]!==t.MOUSE_EVENT_ID)if(e.changedTouches&&n.length<i._max_points){var s=e.changedTouches,o=Array.isArray(s),a=0;for(s=o?s:s[Symbol.iterator]();;){var _;if(o){if(a>=s.length)break;_=s[a++]}else{if((a=s.next()).done)break;_=a.value}var u=_;if(-1===i._identifiers.indexOf(u.identifier)){r=u;break}}}else 0===n.length&&Math.pow(2,e.button)&i.mouse_mask&&(r=e);r&&i.addPoint(r,e)},i._move=function(e,t,r){var n=i._activated_listener,s=i._points[r],o=t[i.pointX],a=t[i.pointY];if(n.dragMove){var _=[o-s.mx,a-s.my];n.dragMove(e,_,t)?(s.mx=o-_[0],s.my=a-_[1]):(s.mx=o,s.my=a)}n.click&&Math.abs(o-s.dx)+Math.abs(a-s.dy)>i._mesh_value&&(n.click=!1)},i._move2=function(e,r,n){var s=t.STATES,o=i._activated_listener,a=i._process_values,_=i._points,u=_[n],c=_[1===n?0:1],f=r[i.pointX]-u.mx,l=r[i.pointY]-u.my;if(o.dragMove2){var p=[f/2,l/2];o.dragMove2(e,p,r)&&(f-=2*p[0],l-=2*p[1])}u.mx=u.mx+f,u.my=u.my+l;var d=(u.mx+c.mx)/2,v=(u.my+c.my)/2;if(o.pinch){var h=Math.sqrt(Math.pow(u.mx-c.mx,2)+Math.pow(u.my-c.my,2));i._process_status&s.IS_PINCH?o.pinch(e,-(a.sd-(a.sd=h))):Math.abs(h-a.sd)>i._mesh_value&&(i._process_status|=s.IS_PINCH,o.pinch(e,-(a.sd-(a.sd=h)),[d,v]))}if(o.rotate){var y=0===n?1:n,E=_[0].mx-_[y].mx,O=_[0].my-_[y].my,k=Math.atan2(O,E);k*a.ra<=0&&(a.ra=-a.ra),i._process_status&s.IS_ROTATE?(o.rotate(e,k-a.ra),a.ra=k):Math.abs(k-a.ra)>.01*Math.PI&&(i._process_status|=s.IS_ROTATE,o.rotate(e,k-a.ra,[d,v]),a.ra=k)}},i.cursorMove=function(e){i.eventDispenser(e,i._points.length<2?i._move:i._move2)},i._leave=function(e,r,n){var o;i._identifiers.splice(n,1),i._points.splice(n,1);var a=t.STATES,_=i._identifiers.length,u=i._activated_listener;switch(!0){case _<1:i.setListener((s(o={},a.MOUSE_DOWN,!0),s(o,a.MOUSE_MOVE,!1),s(o,a.MOUSE_UP,!1),s(o,a.TOUCH_MOVE,!1),s(o,a.TOUCH_END,!1),s(o,a.TOUCH_CANCEL,!1),o)),i._process_status=0,e&&(u.dragEnd&&u.dragEnd(e,r),u.click&&u.click(e,r));break;case e&&_<i._max_points:if(i._process_status=a.IS_DRAG,e.targetTouches&&e.targetTouches.length>=i._max_points){var c=e.targetTouches,f=Array.isArray(c),l=0;for(c=f?c:c[Symbol.iterator]();;){var p;if(f){if(l>=c.length)break;p=c[l++]}else{if((l=c.next()).done)break;p=l.value}var d=p;if(-1===i._identifiers.indexOf(d.identifier)){i.registPoint(e,d);break}}}}},i.cursorUp=function(e){i.eventDispenser(e,i._leave)},i.keyDown=function(e){var r=i._process_values.kd_tasks;function n(t){if(t){for(var n=t._listeners?t._listeners.length:0,i=0;i<n;i++)if(!0===t._listeners[i](e,t._path))return!0;t._reference>n&&-1===r.indexOf(t)&&r.push(t)}}var s=t._PRIVATE_METHODS.get_keys(e);if(!r.some((function(e){return s.some((function(t){return n(e[t])}))}))){var o=s,a=Array.isArray(o),_=0;for(o=a?o:o[Symbol.iterator]();;){var u;if(a){if(_>=o.length)break;u=o[_++]}else{if((_=o.next()).done)break;u=_.value}var c=u;if(n(i._registered_listener.keyDown[c]))break}}},i.keyUp=function(e){for(var r=t._PRIVATE_METHODS.get_keys(e),n=i._process_values.kd_tasks,s=function(e){r.some((function(t){return-1!==n[e]._parts.indexOf(t)}))&&n.splice(e--,1),o=e},o=0;o<n.length;o++)s(o);var a=i._registered_listener.keyUp,_=r,u=Array.isArray(_),c=0;for(_=u?_:_[Symbol.iterator]();;){var f;if(u){if(c>=_.length)break;f=_[c++]}else{if((c=_.next()).done)break;f=c.value}var l=f;a[l]&&a[l].some((function(t){return t(e)}))}},i.keyPress=function(e){var r=t._PRIVATE_METHODS.get_keys(e),n=i._registered_listener.keyPress,s=r,o=Array.isArray(s),a=0;for(s=o?s:s[Symbol.iterator]();;){var _;if(o){if(a>=s.length)break;_=s[a++]}else{if((a=s.next()).done)break;_=a.value}var u=_;n[u]&&n[u].some((function(t){return t(e)}))}},i.registListener(r),i}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function\");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(t,e),f(t,[{key:\"on\",value:function(e,t){return this.updateListener(s({},e,t))}},{key:\"off\",value:function(e,t){return this.updateListener(s({},e,t),!0)}},{key:\"activate\",value:function(){this.updateListener()}},{key:\"disable\",value:function(){var e=this;this.setListener(Object.keys(this._listener_status).reduce((function(t,r){return e._listener_status[r]&&(t[r]=!1),t}),{}))}},{key:\"updateListener\",value:function(e,r){var n,i=this._registered_listener,o=t.STATES;if(e)for(var a in e)for(var _ in t.PATTERN_MAP)t.PATTERN_MAP[_].test(a)&&(t._LISTENER_PREPROCESSOR[_]?e[a]&&t._LISTENER_PREPROCESSOR[_].call(this,a,e[a],r):i[_]=r?null:e[a]);this._max_points=i.pinch||i.rotate||i.dragMove2?2:1;var u=!!(i.dragStart||i.dragMove||i.dragMove2||i.dragEnd||i.click||i.pinch||i.rotate);return this.setListener((s(n={},o.MOUSE_DOWN,u),s(n,o.TOUCH_START,u),s(n,o.KEY_DOWN,i.keyDown._reference>0),s(n,o.KEY_UP,i.keyDown._reference>0||i.keyUp._reference>0),s(n,o.KEY_PRESS,i.keyPress._reference>0),n)),this}},{key:\"break\",value:function(){for(var e=this._identifiers.length;--e>=0;)this._leave(void 0,void 0,e)}},{key:\"removePoint\",value:function(e){isNaN(e)&&(e=e?this._identifiers.indexOf(e.identifier||t.MOUSE_EVENT_ID):0),this._leave(void 0,void 0,e)}},{key:\"addPoint\",value:function(e,r){var n=this._points,i=t.CURSOR_EVENT_HANDLES.length;if(0===n.length){var s=this._registered_listener,o=r&&s.dragStart&&s.dragStart(r,e)||!1;if(!0===o)return;i=0,t.CURSOR_EVENT_HANDLES.reduce((function(e,t){return s[t]&&(!1===o||~o.indexOf(t))?(i++,e[t]=s[t]):delete e[t],e}),this._activated_listener)}(i>1||i>0&&!this._activated_listener.dragStart)&&this.registPoint(r,e)}},{key:\"registPoint\",value:function(e){var r,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,o=t.STATES,a=this._points,_=this._activated_listener,u=i[this.pointX],c=i[this.pointY];switch(a.push({dx:u,dy:c,mx:u,my:c}),this._identifiers.push(isNaN(i.identifier)?t.MOUSE_EVENT_ID:i.identifier),a.length){case 1:this._process_status=o.IS_DRAG,n=this._is_mouse_event,this.setListener((s(r={},o.MOUSE_DOWN,n),s(r,o.MOUSE_MOVE,n),s(r,o.MOUSE_UP,n),s(r,o.TOUCH_MOVE,!n),s(r,o.TOUCH_END,!n),s(r,o.TOUCH_CANCEL,!n),r));break;case 2:this._process_values.sd=Math.sqrt(Math.pow(a[0].mx-a[1].mx,2)+Math.pow(a[0].my-a[1].my,2)),this._process_values.ra=Math.atan2(a[0].my-a[1].my,a[0].mx-a[1].mx),_.click&&(_.click=!1)}}},{key:\"registListener\",value:function(e){this.updateListener(e)}},{key:\"removeListener\",value:function(e){e&&this.updateListener(e,!0)}}]),t}(p);try{window.InputListener=d}catch(e){}e.exports=d}])}));\n//# sourceMappingURL=input_listener.js.map"],"sourceRoot":""}