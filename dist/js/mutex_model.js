!function(o,r){if("object"==typeof exports&&"object"==typeof module)module.exports=r();else if("function"==typeof define&&define.amd)define([],r);else{var t=r();for(var n in t)("object"==typeof exports?exports:o)[n]=t[n]}}(window,(function(){return function(o){var r={};function t(n){if(r[n])return r[n].exports;var e=r[n]={i:n,l:!1,exports:{}};return o[n].call(e.exports,e,e.exports,t),e.l=!0,e.exports}return t.m=o,t.c=r,t.d=function(o,r,n){t.o(o,r)||Object.defineProperty(o,r,{enumerable:!0,get:n})},t.r=function(o){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},t.t=function(o,r){if(1&r&&(o=t(o)),8&r)return o;if(4&r&&"object"==typeof o&&o&&o.__esModule)return o;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:o}),2&r&&"string"!=typeof o)for(var e in o)t.d(n,e,function(r){return o[r]}.bind(null,e));return n},t.n=function(o){var r=o&&o.__esModule?function(){return o.default}:function(){return o};return t.d(r,"a",r),r},t.o=function(o,r){return Object.prototype.hasOwnProperty.call(o,r)},t.p="",t(t.s=1)}([,function(o,r,t){"use strict";var n,e=this&&this.__assign||function(){return(e=Object.assign||function(o){for(var r,t=1,n=arguments.length;t<n;t++)for(var e in r=arguments[t])Object.prototype.hasOwnProperty.call(r,e)&&(o[e]=r[e]);return o}).apply(this,arguments)};Object.defineProperty(r,"__esModule",{value:!0}),function(o){o[o.USE_CHECK=1]="USE_CHECK",o[o.FILL_EACHMODEL=16]="FILL_EACHMODEL",o[o.USE_OFFSET=256]="USE_OFFSET",o[o.USE_EACHOFFSET=4096]="USE_EACHOFFSET"}(n||(n={}));var s=function(){function o(o,r){void 0===r&&(r=o.reduce((function(o,r){return Math.max(o,(r.col||0)+(r.colspan||1))}),1)),this.model_map=new Array,this.model_list=new Array,this._ncols=null,this.model_list=this.model_list.concat(o),this.ncols=r}return Object.defineProperty(o.prototype,"ncols",{get:function(){return this._ncols},set:function(r){if(r!==this._ncols){this._ncols=r,this.model_map.splice(0,this.model_map.length);var t=this.model_list.splice(0,this.model_list.length),n=this._fill(t,o.STATES.USE_CHECK|o.STATES.FILL_EACHMODEL);this.append(n)}},enumerable:!0,configurable:!0}),o.prototype.fill=function(r){r instanceof Array||(r=[r]),this._fill(r,o.STATES.FILL_EACHMODEL)},o.prototype.clear=function(o){var r=this.model_list.indexOf(o),t=0;for(~r||this.model_list.splice(r,1);~(r=this.model_map.indexOf(o));)t++,this.model_map[r]=void 0;return t},o.prototype.remove=function(o){o instanceof Array||(o=[o]),this._fill(o)},o.prototype.move=function(r,t,n){void 0===n&&(n=0),r instanceof Array||(r=[r]),this.remove(r),this._fill(r,n|o.STATES.FILL_EACHMODEL|o.STATES.USE_OFFSET,t)},o.prototype.getModel=function(o,r){if(o>=0&&r>=0&&o<this.ncols)return this.model_map[o+r*this.ncols]},o.prototype.format=function(o,r,t){return void 0===r&&(r=o.col),void 0===t&&(t=o.row),o.col=Math.round(Math.max(Math.min(r,this.ncols-o.colspan),0)),o.row=Math.round(Math.max(t,0)),o},o.prototype.trim=function(){for(var o=Math.ceil(this.model_map.length/this.ncols),r=[],t=1;t<o;t++)for(var n=0;n<this.ncols;n++){var e=t*this.ncols+n,s=this.model_map[e];if(s&&s.row===t){var l=this._pathTest([s],[0,-t-1],s);l>0&&(r.push(s),this.move([s],[0,-l])),n+=s.colspan-1}}return r},o.prototype.append=function(r){r instanceof Array||(r=[r]);for(var t=0,n=r;t<n.length;t++){var e=n[t];e.colspan>this.ncols&&(e.colspan=this.ncols);for(var s=Math.ceil(this.model_map.length/this.ncols),l=0,a=0,i={col:0,row:s,colspan:e.colspan,rowspan:e.rowspan},c=0,p=this.ncols-e.colspan;c<=p;c++){i.col=c;var f=this._pathTest([i],[0,-s-1],i);l<f&&(l=f,a=c)}e.col=a,e.row=s-l,this._fill([e],o.STATES.FILL_EACHMODEL)}},o.prototype.alloc=function(r,t){var n=this.format(e({},r)),s=this.cover(n),l=s.slice();if(0===s.length)return l;var a=this.calcWrap(s);if(t&&n.col===a.col&&n.row===a.row&&t.colspan===a.colspan&&t.rowspan===a.rowspan&&(Math.abs(r.col-a.col)+Math.abs(r.row-a.row))/(t.colspan+t.rowspan)<.06&&Math.abs(t.col-a.col)/t.colspan+Math.abs(t.row-a.row)/t.rowspan>1)this.move(s,[t.col-a.col,t.row-a.row]);else if(s.length>1&&a.colspan+a.rowspan>2*(n.colspan+n.rowspan)||!this._compress(n,s,a,r)){for(var i=0;i<s.length;i++)this._compress(n,[s[i]],s[i],void 0,!1)&&s.splice(i--,1);if(0===s.length)return l;var c=[],p=[];a=this.calcWrap(s);for(var f=n.colspan-Math.max(a.col-n.col,0)-Math.max(n.col+n.colspan-a.colspan-a.col,0),h=[{col:Math.max(n.col,a.col),row:n.row,colspan:f,rowspan:0}],u={},v=[new Array(f).fill(n.rowspan)];h.length;){var w=[],d={},_=[];for(var m in u)u[m].sort((function(o,r){return o.row-r.row}));for(i=0;i<h.length;i++){for(var E=h[i],y=v[i],S=(g=E.col)+E.colspan;g<S;g++){if(H=u[g]){for(var O=0,M=0;M<H.length-1;M++){var b=H[M];if(!(b.row<E.row))break;O+=H[M+1].row-(b.row+b.rowspan)}y[g-E.col]-=O}}if((T=Math.max.apply(Number,y))>0)if(v[i]=T,-1===(M=c.indexOf(E)))M=c.length,c.push(E),p.push(T);else{if(p[M]>=T)continue;p[M]=T}else h.splice(i,1),v.splice(i,1),i--}for(M=0;M<h.length;M++){E=h[M];var T=v[M];var g=E.col;o:for(S=g+E.colspan;g<S;g++)for(var A=E.row+E.rowspan,x=A+T;A<x;A++){var F=this.model_map[g+A*this.ncols];if(F){var L=w.indexOf(F),C=(y=void 0,x-A+Math.max(E.row-F.row,0));if(-1===L){var H,j=c.indexOf(F);if(j>=0&&p[j]>=C)continue o;w.push(F),_.push(y=new Array(F.colspan).fill(0)),(H=d[g]||(d[g]=[])).push({row:F.row,rowspan:F.rowspan})}else y=_[L];y[g-F.col]=Math.max(y[g-F.col],C);break}}}h=w,u=d,v=_}c.splice(0,1),p.splice(0,1),this.move(c,p.map((function(o){return[0,o]})),o.STATES.USE_EACHOFFSET),l=l.concat(c)}return l},o.prototype.cover=function(o){for(var r=[],t=o.col,n=o.row,e=0;e<o.rowspan;e++)for(var s=0;s<o.colspan;s++){var l=this.model_map[s+t+(e+n)*this.ncols];if(void 0!==l){~r.indexOf(l)||r.push(l);var a=l.colspan+l.col-1;s+t<a&&(s=a-t)}}return r},o.prototype.calcWrap=function(o){for(var r={col:o[0].col,row:o[0].row,colspan:o[0].colspan,rowspan:o[0].rowspan},t=1;t<o.length;t++){var n=o[t];r.col>n.col&&(r.colspan+=r.col-n.col,r.col=n.col),r.row>n.row&&(r.rowspan+=r.row-n.row,r.row=n.row),r.colspan+r.col<n.col+n.colspan&&(r.colspan+=n.col+n.colspan-r.col-r.colspan),r.rowspan+r.row<n.row+n.rowspan&&(r.rowspan+=n.row+n.rowspan-r.row-r.rowspan)}return r},o.prototype.calcOffset=function(o,r){return{l:o.col-(r.col+r.colspan),r:o.col+o.colspan-r.col,t:o.row-(r.row+r.rowspan),b:o.row+o.rowspan-r.row}},o.prototype._fill=function(r,t,n){void 0===t&&(t=0);var e=o.STATES,s=t&e.USE_CHECK?[]:void 0,l=this.model_map,a=this.model_list,i=this.ncols;o:for(var c=0;c<r.length;c++){var p=r[c];if(t&e.USE_CHECK&&(isFinite(p.colspan)||(p.colspan=1),isFinite(p.rowspan)||(p.rowspan=1),isNaN(p.col+p.row)||p.col+p.colspan>i))s.push(p);else{var f=a.indexOf(p);if(t&e.FILL_EACHMODEL){if(-1!==f)continue;a.push(p)}else f>=0&&a.splice(f,1);t&e.USE_EACHOFFSET?(p.col+=n[c][0],p.row+=n[c][1]):t&e.USE_OFFSET&&(p.col+=n[0],p.row+=n[1]);for(var h=p.col,u=p.row,v=p.colspan,w=p.rowspan,d=0;d<w;d++)for(var _=0;_<v;_++){var m=_+h+(d+u)*i;if(t&e.USE_CHECK&&void 0!==l[m]){do{for(;_--;)l[_+h+(d+u)*i]=void 0;_=v}while(d--);t&e.FILL_EACHMODEL&&a.pop(),s.push(p);continue o}l[m]=t&e.FILL_EACHMODEL?p:n}}}return s},o.prototype._pathTest=function(o,r,t){void 0===t&&(t=this.calcWrap(o));for(var n=0|r[0],e=0|r[1],s=0,l=0,a=0,i=n&&n/Math.abs(n),c=e&&e/Math.abs(e);s!==n||l!==e;){if(s!==n?s+=i:l+=c,t.col+s<0||t.col+s+t.colspan>this.ncols||t.row+l<0)return a;for(var p=0,f=o;p<f.length;p++)for(var h=f[p],u=h.row,v=u+h.rowspan;u<v;u++)for(var w=h.col,d=w+h.colspan;w<d;w++){var _=w+s+(u+l)*this.ncols;if(this.model_map[_]&&-1===o.indexOf(this.model_map[_]))return a}a+=1}return!0},o.prototype._compress=function(o,r,t,n,e){void 0===r&&(r=this.cover(o)),void 0===t&&(t=this.calcWrap(r)),void 0===e&&(e=!0);var s=o.rowspan/o.colspan,l=t.colspan/t.rowspan,a=this.calcOffset(o,t),i=n?this.calcOffset(n,t):a,c=[Math.abs(s*i.l),[a.l,0]],p=[Math.abs(s*i.r),[a.r,0],c];c.push(p),p.push(c);var f,h=[Math.abs(l*i.t),[0,a.t]];e&&(f=[Math.abs(l*i.b),[0,a.b]],h.push(f),f.push(h));for(var u=(e?[c,p,h,f]:[c,p,h]).sort((function(o,r){return o[0]-r[0]})),v=0;v<u.length;v++){var w=u.lastIndexOf(u[v][2]);if(w>v&&(u.splice(w,1),u.splice(v+1,0,u[v][2])),!0===this._pathTest(r,u[v][1],t))return this.move(r,u[v][1]),!0}return!1},o.STATES=n,o}();r.default=s}])}));